var O=Object.defineProperty;var P=(i,t,e)=>t in i?O(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var c=(i,t,e)=>(P(i,typeof t!="symbol"?t+"":t,e),e);import{n as p,S as I,t as R,D as _,ar as k,as as y,w as T,z as L,d as f,a6 as b,Y as v,am as G,an as H,at as N,ap as M,C as E,ak as D,V as S,X as $,au as q,v as C,aa as F,T as U,p as j,y as z}from"./index.5c4cb14.js";import{P as V}from"./paneDialogMixin.5c4cb14.js";const W=["gain"],B=["holdDuration","fadeIn","fadeOut"],X={components:{Slider:I,DropdownButton:R},props:{type:{required:!0,type:String},error:{required:!1,type:String}},mixins:[_],data:()=>({url:null,frequencyHz:null,gain:null,fadeOut:null,delay:null,fadeIn:null,holdDuration:null,osc:null,startGain:null,endGain:null,startTime:null,dynamicGain:!0,dynamicLength:!0,uploadedSound:null,showAdvanced:!1}),computed:{title(){return this.type==="play"?"Synthetize sound":"Import your own"},descriptions(){return k},frequency:{get(){return this.frequencyHz},set(i){if(isNaN(i)){this.frequencyHz=this.noteToFrequency(i);return}this.frequencyHz=+i}},litteral(){const i=y[this.type],e=Object.keys(i).map(s=>this.dynamicGain&&W.indexOf(s)!==-1||this.dynamicLength&&B.indexOf(s)!==-1?this[s]?"gain*"+this[s]:i[s]!=0?0:null:this[s]!=i[s]?this[s]:null);for(let s=e.length-1;s>=0&&e[s]===null;s--)e.splice(s,1);return`${this.type}(${e.map(s=>s===null?"":s)})`}},created(){this.setDefaultAudioAttributes()},beforeDestroy(){this.uploadedSound&&T.removeSound(this.uploadedSound).then(()=>{this.$store.dispatch("app/showNotice",{title:`Deleted ${this.uploadedSound} (canceled)`,type:"info"})})},methods:{setDefaultAudioAttributes(){const i=y[this.type];for(const t in i)this[t]=i[t]},noteToFrequency(i){const t=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"];let e,s;return i.length===3?e=i.charAt(2):e=i.charAt(1),s=t.indexOf(i.slice(0,-1)),s<3?s=s+12+(e-1)*12+1:s=s+(e-1)*12+1,+(440*Math.pow(2,(s-49)/12)).toFixed(2)},async handleFile(i){const t=i.target.files[0];if(t)try{const e=await L.importSound(t);e?(this.uploadedSound&&T.removeSound(this.uploadedSound),this.uploadedSound=this.url=e.name):this.url=t.name}catch(e){this.$store.dispatch("app/showNotice",{title:e.message,type:"error"});return}},reset(i){const t=y[this.type][i];this[i]=t},submit(){this.$emit("append",{litteral:this.litteral,uploadedSound:this.uploadedSound}),this.uploadedSound=null,this.close()}}};var J=function(){var t=this,e=t._self._c;return e("Dialog",{staticClass:"pane-dialog -auto",on:{clickOutside:t.close,mousedown:function(s){t.clickOutsideClose=!1},mouseup:function(s){t.clickOutsideClose=!0}},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",{staticClass:"dialog__title"},[t._v(t._s(t.title))])]},proxy:!0},{key:"footer",fn:function(){return[e("a",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn -text mrauto",attrs:{href:"javascript:void(0);",title:"Restart audio service (clear ALL queue)"},on:{click:function(s){return t.$emit("stop")}}},[e("i",{staticClass:"icon-refresh mr8"}),t._v(" Restart audio ")]),e("a",{staticClass:"btn -text mr8",attrs:{href:"javascript:void(0);"},on:{click:function(s){return t.close(!1)}}},[t._v("Cancel")]),e("button",{staticClass:"btn -large",on:{click:t.submit}},[e("i",{staticClass:"icon-check mr4"}),t._v(" Ok ")])]},proxy:!0}])},[t.type==="play"?e("div",{staticClass:"form-group mb16"},[e("label",{attrs:{for:"audio-assistant-source"}},[e("i",{staticClass:"icon-music-note mr8"}),t._v(" Frequency "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.descriptions.frequency}})]),e("div",{staticClass:"column"},[e("slider",{staticClass:"mrauto -fill mt8 mb8",attrs:{min:0,max:8902,step:1,label:!0,"show-completion":!0,value:t.frequency},on:{input:function(s){t.frequency=s},reset:function(s){return t.reset("frequency")}}}),e("editable",{staticClass:"-center text-nowrap ml8",staticStyle:{"line-height":"1"},attrs:{value:t.frequency},on:{input:function(s){t.frequency=s}}})],1)]):e("div",{staticClass:"form-group mb16"},[e("label",{attrs:{for:"audio-assistant-source"}},[e("i",{staticClass:"icon-music-note mr8"}),t._v(" Source ")]),e("button",{staticClass:"btn -file -blue -large -cases w-100",on:{change:t.handleFile}},[e("i",{staticClass:"icon-upload mr8"}),t._v(" Browse "),e("input",{staticClass:"input-file",attrs:{type:"file",accept:"audio/*"}})])]),e("div",{staticClass:"form-group mb16"},[e("label",[t._v("Gain "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.descriptions.gain}})]),e("div",{staticClass:"column"},[e("slider",{attrs:{min:0,max:2,step:.01,label:!0,"show-completion":!0,value:t.gain},on:{input:function(s){t.gain=s},reset:function(s){return t.reset("gain")}}}),e("label",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"checkbox-control checkbox-control-input",attrs:{title:"Dynamic"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.dynamicGain,expression:"dynamicGain"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.dynamicGain)?t._i(t.dynamicGain,null)>-1:t.dynamicGain},on:{change:function(s){var o=t.dynamicGain,n=s.target,a=!!n.checked;if(Array.isArray(o)){var r=null,l=t._i(o,r);n.checked?l<0&&(t.dynamicGain=o.concat([r])):l>-1&&(t.dynamicGain=o.slice(0,l).concat(o.slice(l+1)))}else t.dynamicGain=a}}}),e("div")])],1)]),e("div",{staticClass:"form-group mb16"},[e("label",[t._v("Duration "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.descriptions.holdDuration}})]),e("div",{staticClass:"column"},[e("slider",{attrs:{min:0,max:10,step:.1,label:!0,"show-completion":!0,value:t.holdDuration},on:{input:function(s){t.holdDuration=s},reset:function(s){return t.reset("holdDuration")}}}),e("label",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"checkbox-control checkbox-control-input",attrs:{title:"Dynamic"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.dynamicLength,expression:"dynamicLength"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.dynamicLength)?t._i(t.dynamicLength,null)>-1:t.dynamicLength},on:{change:function(s){var o=t.dynamicLength,n=s.target,a=!!n.checked;if(Array.isArray(o)){var r=null,l=t._i(o,r);n.checked?l<0&&(t.dynamicLength=o.concat([r])):l>-1&&(t.dynamicLength=o.slice(0,l).concat(o.slice(l+1)))}else t.dynamicLength=a}}}),e("div")])],1)]),e("section",{staticClass:"section"},[t.showAdvanced?e("div",[t.type==="play"?e("div",{staticClass:"form-group mb16"},[e("label",[t._v("Wave type ("),e("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/OscillatorNode/type"}},[t._v("learn more")]),t._v(")")]),e("dropdown-button",{staticClass:"-outline form-control -arrow",attrs:{options:["'triangle'","'square'","'sine'","'sawtooth'"]},on:{input:function(s){t.osc=s}},scopedSlots:t._u([{key:"selection",fn:function(){return[t._v(" "+t._s(t.osc.replace(/'/g,""))+" ")]},proxy:!0},{key:"option",fn:function({value:s}){return[t._v(" "+t._s(s.replace(/'/g,""))+" ")]}}],null,!1,2424831711),model:{value:t.osc,callback:function(s){t.osc=s},expression:"osc"}})],1):t._e(),e("div",{staticClass:"column mb16"},[e("div",{staticClass:"form-group -fill"},[e("label",[t._v("Fade In "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.descriptions.fadeIn}})]),e("slider",{staticClass:"mt8",attrs:{min:0,max:10,step:.1,label:!0,"show-completion":!0,value:t.fadeIn},on:{input:function(s){t.fadeIn=s},reset:function(s){return t.reset("fadeIn")}}})],1),e("div",{staticClass:"ml8 form-group -fill"},[e("label",[t._v("Fade Out "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.descriptions.fadeOut}})]),e("slider",{staticClass:"mt8",attrs:{min:0,max:10,step:.1,label:!0,"show-completion":!0,value:t.fadeOut},on:{input:function(s){t.fadeOut=s},reset:function(s){return t.reset("fadeOut")}}})],1)]),e("div",{staticClass:"column mb16"},[e("div",{staticClass:"form-group -fill"},[e("label",[t._v("Start Gain "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.descriptions.startGain}})]),e("slider",{staticClass:"mt8",attrs:{min:1e-4,max:1,step:.001,label:!0,"show-completion":!0,value:t.startGain},on:{input:function(s){t.startGain=s},reset:function(s){return t.reset("startGain")}}})],1),e("div",{staticClass:"ml8 form-group -fill"},[e("label",[t._v("End Gain "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.descriptions.endGain}})]),e("slider",{staticClass:"mt8",attrs:{min:1e-4,max:1,step:.001,label:!0,"show-completion":!0,value:t.endGain},on:{input:function(s){t.endGain=s},reset:function(s){return t.reset("endGain")}}})],1)]),e("div",{staticClass:"form-group mb16"},[e("label",[t._v("Delay "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.descriptions.delay}})]),e("slider",{staticClass:"mt8",attrs:{min:0,max:10,step:.1,label:!0,"show-completion":!0,value:t.delay},on:{input:function(s){t.delay=s},reset:function(s){return t.reset("delay")}}})],1)]):t._e(),e("div",{staticClass:"section__header",on:{click:function(s){t.showAdvanced=!t.showAdvanced}}},[t._v(" Advanced "),e("i",{staticClass:"icon-up-thin"})])]),e("div",{staticClass:"form-group mt16"},[e("label",{attrs:{for:"audio-assistant-output"}},[t._v(" Output ")]),e("div",{staticClass:"d-flex"},[e("textarea",{ref:"output",staticClass:"form-control",attrs:{id:"audio-assistant-output -code",cols:"20",rows:"4",spellcheck:"false",readonly:""},domProps:{value:t.litteral}}),e("button",{staticClass:"btn -red ml8",on:{click:function(s){return t.$emit("test",{event:s,litteral:t.litteral})}}},[e("i",{staticClass:"icon-volume-high"})])]),t.error?e("p",{staticClass:"form-feedback"},[e("i",{staticClass:"icon-warning mr4"}),t._v(" "+t._s(t.error)+" ")]):t._e()])])},Y=[],K=p(X,J,Y,!1,null,null,null,null);const Q=K.exports,Z={props:{paneId:{required:!0,type:String},thresholds:{required:!0},thresholdId:{required:!0,type:String}},mixins:[_],data:()=>({buyAudio:"",sellAudio:"",buyError:null,sellError:null,showHelp:!1,focusedSide:null,loopingSide:null,dropping:null,liveAnnotation:null,uploadedSounds:[]}),computed:{threshold:function(){return this.thresholds.find(i=>i.id===this.thresholdId)},amounts:function(){return this.thresholds.map(i=>i.amount)},audioPitch:function(){return this.$store.state[this.paneId].audioPitch},audioVolume:function(){return this.$store.state[this.paneId].audioVolume},index:function(){return this.amounts.indexOf(this.threshold.amount)},min:function(){return this.threshold.amount},max:function(){return this.amounts[this.index+1]||this.amounts[this.index]*2}},created(){if(!this.threshold)return this.$nextTick().then(()=>this.close(!1));this.buyAudio=this.threshold.buyAudio||"",this.sellAudio=this.threshold.sellAudio||""},beforeDestroy(){this._loopingTimeout&&(clearTimeout(this._loopingTimeout),this._loopingTimeout=!1);for(const i of this.uploadedSounds)T.removeSound(i).then(()=>{this.$store.dispatch("app/showNotice",{title:`Deleted ${i} (canceled)`,type:"info"})})},methods:{setInput(i,t){this[t+"Audio"]=i,this.liveAnnotation=null},saveInputs(){this.validate(!0)&&(this.$store.commit(this.paneId+"/SET_THRESHOLD_AUDIO",{id:this.thresholdId,buyAudio:this.buyAudio,sellAudio:this.sellAudio}),this.uploadedSounds.splice(0,this.uploadedSounds.length),this.close(!0))},validate(i=!1){for(const t of["buy","sell"]){const e=this[t+"Audio"];try{this.emulateAudioFunction(e,t)}catch{return i&&f.confirm({message:`Please check that ${t} audio script is syntactically correct.`,ok:"OK",cancel:!1}),!1}}return!0},async testCustom(i,t,e){return this._loopingTimeout&&this.stopLoop(),e||(e=this[i+"Audio"]),await this.test(e,i,t)},testOriginal(i,t){this._loopingTimeout&&this.stopLoop();const e=this.threshold[i+"Audio"];this.test(e,i,t)},stopLoop(){this._loopingTimeout&&(clearTimeout(this._loopingTimeout),this._loopingTimeout=!1,this.loopingSide=null)},loopSide(i){this._loopingTimeout||(this.loopingSide=i),this._loopingTimeout=setTimeout(()=>{this.test(this[i+"Audio"],i),this.loopSide(i)},Math.random()*100)},restartWebAudio(){b.reconnect()},async test(i,t,e){let s=1,o;const n=this.max-this.min;if(e&&e.shiftKey||!n?o=this.min:(o=this.min+Math.random()*n,s=o/this.amounts[1]),o){const a=await this.emulateAudioFunction(i,t,s);return a&&e&&this.$store.dispatch("app/showNotice",{id:"testing-threshold-audio",type:t==="buy"?"success":"error",title:"NOW PLAYING : "+v(o)+" "+t.toUpperCase()+" trade",timeout:1e3}),a}},formatAmount(i){return v(i)},async emulateAudioFunction(i,t,e){try{const s=await b.buildAudioFunction(i,t,this.audioPitch,this.audioVolume,!0);return typeof e<"u"&&s(b,e),this[t+"Error"]=null,!0}catch(s){return this[t+"Error"]=s.message,!1}},openSoundAssistant(i,t){const e=f.open(Q,{type:i,error:this[t+"Error"]});e.$on("test",({event:s,litteral:o})=>this.testCustom(t,s,o)),e.$on("stop",this.restartWebAudio),e.$on("append",({litteral:s,uploadedSound:o})=>{o&&this.uploadedSounds.push(o),this[t+"Audio"].trim().length?this[t+"Audio"]+=`
${s}`:this[t+"Audio"]=s})},handleDropEnter(i){this.dropping=i},handleDropLeave(i){i.target===i.currentTarget&&(this.dropping=null)},async handleDrop(i,t){if(!(!i.dataTransfer.files||!i.dataTransfer.files.length)){if(i.preventDefault(),i.stopPropagation(),i.type!=="drop")return!1;for(const e of i.dataTransfer.files)await this.importSound(e,t);this.dropping=null}},async importSound(i,t){try{const e=await L.importSound(i);e&&this.uploadedSounds.push(e.name);const s=`playurl(${i.name})`;this[t+"Audio"].trim().length?this[t+"Audio"]+=`
${s}`:this[t+"Audio"]=s}catch(e){this.$store.dispatch("app/showNotice",{title:e.message,type:"error"});return}},async scheduleLiveAnnotation(i,t){this.focusedSide=t,this._liveAnnotationTimeout&&clearTimeout(this._liveAnnotationTimeout),this._liveAnnotationTimeout=setTimeout(this.findCurrentParameter.bind(this,i.currentTarget,t),200)},findCurrentParameter(i){if(this._liveAnnotationTimeout=null,!("selectionStart"in i&&document.activeElement==i))return;let t=i.selectionStart-1,e=i.value.slice(),s=t;for(s;s>=0;s--){if(/\n/.test(e[s])){s++;break}s===0&&t--}s>=0&&(e=e.slice(s)),t-=s;const o=e.indexOf(`
`);if(o>=0&&(e=e.slice(0,o)),!e.length)return;const n=new RegExp("(play(?:url)?)\\(","g");let a;do if(a=n.exec(e)){const r=a[1],l=a.index,m=G(e,l+r.length);if(t<l+r.length||t>=m)continue;const h=H(e.slice(l+r.length+1,m),!1,5);let d=l+r.length+1;for(let u=0;u<h.length;u++){if(t<=d+h[u].length-1){this.showParameterAnnotation(r,u);return}d+=h[u].length+1}}while(a);this.liveAnnotation&&(this.liveAnnotation=null)},showParameterAnnotation(i,t){let e;const s=N[i][t];s?e=`${s.toUpperCase()} : ${k[s]}`:e=`Too many parameters on ${i}() !`,this.liveAnnotation=e},reset(i){const t=JSON.parse(JSON.stringify(M[this.$store.state.panes.panes[this.paneId].type].state));t.thresholds[Math.min(this.index,3)]&&(this[i+"Audio"]=t.thresholds[Math.min(this.index,3)][i+"Audio"])}}};var tt=function(){var t=this,e=t._self._c;return e("Dialog",{staticClass:"pane-dialog -auto",on:{clickOutside:t.close,mousedown:function(s){t.clickOutsideClose=!1},mouseup:function(s){t.clickOutsideClose=!0}},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",{staticClass:"d-flex"},[e("div",{staticClass:"dialog__title -center"},[t._v("Threshold")]),e("code",{staticClass:"ml4 -filled"},[e("small",[t._v(t._s(t.formatAmount(t.threshold.amount)))])])])]},proxy:!0},{key:"footer",fn:function(){return[e("a",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn -text mrauto",attrs:{href:"javascript:void(0);",title:"Restart audio service (clear ALL queue)"},on:{click:function(s){return t.restartWebAudio()}}},[e("i",{staticClass:"icon-refresh mr8"}),t._v(" Restart audio ")]),e("a",{staticClass:"btn -text mr8",attrs:{href:"javascript:void(0);"},on:{click:function(s){return t.close(!1)}}},[t._v("Cancel")]),e("button",{staticClass:"btn -large -green",on:{click:function(s){return t.saveInputs()}}},[e("i",{staticClass:"icon-check mr4"}),t._v(" Save ")])]},proxy:!0}])},[e("div",{staticClass:"form-group mb16"},[e("label",{attrs:{for:""}},[t._v(" When buy ")]),t.liveAnnotation&&t.focusedSide==="buy"?e("div",{staticClass:"live-annotation"},[e("div",{staticClass:"live-annotation__tooltip"},[t._v(t._s(t.liveAnnotation))])]):t._e(),e("div",{staticClass:"d-flex",on:{drop:function(s){return t.handleDrop(s,"buy")},dragover:function(s){return t.handleDrop(s,"buy")},dragenter:function(s){return t.handleDropEnter("buy")},dragleave:t.handleDropLeave}},[t.buyAudio!==t.threshold.buyAudio?e("button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn -green mr8",attrs:{title:"Original"},on:{click:function(s){return t.testOriginal("buy",s)}}},[e("i",{staticClass:"icon-volume-high"})]):t._e(),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.buyAudio,expression:"buyAudio"}],staticClass:"form-control -code",class:[t.dropping==="buy"&&"-dropping"],domProps:{value:t.buyAudio},on:{blur:function(s){t.liveAnnotation=null},focus:function(s){return t.scheduleLiveAnnotation(s,"buy")},keyup:function(s){return t.scheduleLiveAnnotation(s,"buy")},click:function(s){return t.scheduleLiveAnnotation(s,"buy")},input:function(s){s.target.composing||(t.buyAudio=s.target.value)}}}),e("button",{staticClass:"btn -green ml8",class:[t.loopingSide==="buy"&&"shake-hard"],attrs:{title:"Custom"},on:{click:function(s){return t.testCustom("buy",s)},dblclick:function(s){return t.loopSide("buy")}}},[e("i",{staticClass:"icon-volume-high"})])]),t.focusedSide==="buy"?e("div",{staticClass:"mt8 d-flex"},[e("button",{staticClass:"btn -green -small",on:{click:function(s){return t.openSoundAssistant("play","buy")}}},[e("i",{staticClass:"icon-music-note mr8"}),t._v(" Synthetize sound ")]),e("button",{staticClass:"btn -green -small ml8 mr8",on:{click:function(s){return t.openSoundAssistant("playurl","buy")}}},[e("i",{staticClass:"icon-upload mr8"}),t._v(" Import audio ")]),e("button",{staticClass:"btn -small -red mlauto -text",on:{click:function(s){return t.reset("buy")}}},[e("i",{staticClass:"icon-eraser mr8"}),t._v(" Reset ")])]):t._e(),t.buyError?e("p",{staticClass:"form-feedback"},[e("i",{staticClass:"icon-warning mr4"}),t._v(" "+t._s(t.buyError)+" ")]):t._e()]),e("div",{staticClass:"form-group mb16"},[e("label",{attrs:{for:""}},[t._v(" When sell ")]),t.liveAnnotation&&t.focusedSide==="sell"?e("div",{staticClass:"live-annotation"},[e("div",{staticClass:"live-annotation__tooltip"},[t._v(t._s(t.liveAnnotation))])]):t._e(),e("div",{staticClass:"d-flex",on:{drop:function(s){return t.handleDrop(s,"sell")},dragover:function(s){return t.handleDrop(s,"sell")},dragenter:function(s){return t.handleDropEnter("sell")},dragleave:t.handleDropLeave}},[t.sellAudio!==t.threshold.sellAudio?e("button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn -red mr8",attrs:{title:"Original"},on:{click:function(s){return t.testOriginal("sell",s)}}},[e("i",{staticClass:"icon-volume-high"})]):t._e(),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.sellAudio,expression:"sellAudio"}],staticClass:"form-control -code",class:[t.dropping==="sell"&&"-dropping"],domProps:{value:t.sellAudio},on:{blur:function(s){t.liveAnnotation=null},focus:function(s){return t.scheduleLiveAnnotation(s,"sell")},keyup:function(s){return t.scheduleLiveAnnotation(s,"sell")},click:function(s){return t.scheduleLiveAnnotation(s,"sell")},input:function(s){s.target.composing||(t.sellAudio=s.target.value)}}}),e("button",{staticClass:"btn -red ml8",class:[t.loopingSide==="sell"&&"shake-hard"],on:{click:function(s){return t.testCustom("sell",s)},dblclick:function(s){return t.loopSide("sell")}}},[e("i",{staticClass:"icon-volume-high"})])]),t.focusedSide==="sell"?e("div",{staticClass:"mt8 d-flex"},[e("button",{staticClass:"btn -red -small",on:{click:function(s){return t.openSoundAssistant("play","sell")}}},[e("i",{staticClass:"icon-music-note mr8"}),t._v(" Synthetize sound ")]),e("button",{staticClass:"btn -red -small ml8 mr8",on:{click:function(s){return t.openSoundAssistant("playurl","sell")}}},[e("i",{staticClass:"icon-upload mr8"}),t._v(" Import audio ")]),e("button",{staticClass:"btn -small -red mlauto -text",on:{click:function(s){return t.reset("sell")}}},[e("i",{staticClass:"icon-eraser mr8"}),t._v(" Reset ")])]):t._e(),t.sellError?e("p",{staticClass:"form-feedback"},[e("i",{staticClass:"icon-warning mr4"}),t._v(" "+t._s(t.sellError)+" ")]):t._e()])])},et=[],st=p(Z,tt,et,!1,null,"df1c72f0",null,null);const it=st.exports;var ot=Object.defineProperty,nt=Object.getOwnPropertyDescriptor,at=(i,t,e,s)=>{for(var o=s>1?void 0:s?nt(t,e):t,n=i.length-1,a;n>=0;n--)(a=i[n])&&(o=(s?a(t,e,o):a(o))||o);return s&&o&&ot(t,e,o),o};let A=class extends S{constructor(){super(...arguments);c(this,"paneId");c(this,"threshold");c(this,"canDelete")}get isLegacy(){return this.$store.state.panes.panes[this.paneId].type==="trades"}formatAmount(e){return v(e)}removeThreshold(){if(!this.canDelete){f.confirm({message:"You can't delete the threshold because there is only 2 and the minimum is 2",cancel:null});return}this.$store.commit(this.paneId+"/DELETE_THRESHOLD",this.threshold.id),this.$emit("input",null)}};A=at([E({name:"ThresholdDropdown",components:{ColorPickerControl:D},props:{paneId:{type:String,required:!0},threshold:{required:!0},canDelete:{default:!1}}})],A);var rt=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"threshold-dropdown"},[e("h3",[t._v("@ "+t._s(t.formatAmount(t.threshold.amount)))]),e("div",{staticClass:"form-group mb8 threshold-panel__gif"},[e("div",{staticClass:"column"},[t.isLegacy?e("div",{staticClass:"form-group"},[e("label",[t._v("Buy gif")]),e("input",{staticClass:"form-control w-100",attrs:{type:"text",placeholder:"Giphy keyword"},domProps:{value:t.threshold.buyGif},on:{change:function(s){return t.$store.commit(t.paneId+"/SET_THRESHOLD_GIF",{id:t.threshold.id,side:"buy",value:s.target.value})}}})]):t._e(),t.isLegacy?e("div",{staticClass:"form-group"},[e("label",[t._v("Sell gif")]),e("input",{staticClass:"form-control w-100",attrs:{type:"text",placeholder:"Giphy keyword"},domProps:{value:t.threshold.sellGif},on:{change:function(s){return t.$store.commit(t.paneId+"/SET_THRESHOLD_GIF",{id:t.threshold.id,side:"sell",value:s.target.value})}}})]):t._e()])]),e("div",{staticClass:"form-group mb8 threshold-panel__colors"},[e("label",[t._v("Custom colors")]),e("div",{staticClass:"column mt8"},[e("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"bottom"},expression:"{ placement: 'bottom' }"}],staticClass:"form-group column flex-center",attrs:{title:"When buy"}},[e("p",{staticClass:"help-text -center mr16 mt0 mb0"},[t._v("Buy")]),e("color-picker-control",{attrs:{label:"Buy color",value:t.threshold.buyColor},on:{input:function(s){return t.$store.commit(t.paneId+"/SET_THRESHOLD_COLOR",{id:t.threshold.id,side:"buyColor",value:s})}}})],1),e("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"bottom"},expression:"{ placement: 'bottom' }"}],staticClass:"form-group column flex-center",attrs:{title:"When sell"}},[e("p",{staticClass:"help-text -center mr16 mt0 mb0"},[t._v("Sell")]),e("color-picker-control",{attrs:{label:"Sell color",value:t.threshold.sellColor},on:{input:function(s){return t.$store.commit(t.paneId+"/SET_THRESHOLD_COLOR",{id:t.threshold.id,side:"sellColor",value:s})}}})],1)])]),e("button",{staticClass:"btn -red mt16",attrs:{type:"button"},on:{click:t.removeThreshold}},[e("i",{staticClass:"icon-trash mr8"}),t._v(" Remove ")])])},lt=[],ct=p(A,rt,lt,!1,null,"d2559bbc",null,null);const ut=ct.exports,dt={mixins:[_],data:()=>({includeAmounts:!1,includeColors:!0,includeAudio:!0}),methods:{submit(){this.close({amounts:this.includeAmounts,colors:this.includeColors,audios:this.includeAudio})}}};var ht=function(){var t=this,e=t._self._c;return e("Dialog",{on:{clickOutside:t.close},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",{staticClass:"dialog__title"},[t._v("Configure preset")])]},proxy:!0},{key:"footer",fn:function(){return[e("button",{staticClass:"btn -text mr8",attrs:{type:"button"},on:{click:function(s){return t.close(!1)}}},[t._v(" Cancel ")]),e("button",{staticClass:"btn -large -green",attrs:{type:"button"},on:{click:t.submit}},[e("i",{staticClass:"icon-check mr4"}),t._v(" Submit ")])]},proxy:!0}])},[e("form",{on:{submit:function(s){return s.preventDefault(),t.submit.apply(null,arguments)}}},[e("div",{staticClass:"form-group mb8"},[e("label",[t._v("Choose what to include in preset")]),e("label",{staticClass:"checkbox-control mt16"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.includeAmounts,expression:"includeAmounts"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.includeAmounts)?t._i(t.includeAmounts,null)>-1:t.includeAmounts},on:{change:function(s){var o=t.includeAmounts,n=s.target,a=!!n.checked;if(Array.isArray(o)){var r=null,l=t._i(o,r);n.checked?l<0&&(t.includeAmounts=o.concat([r])):l>-1&&(t.includeAmounts=o.slice(0,l).concat(o.slice(l+1)))}else t.includeAmounts=a}}}),e("div"),e("span",[t._v("Amounts")])])]),e("div",{staticClass:"form-group mb8"},[e("label",{staticClass:"checkbox-control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.includeColors,expression:"includeColors"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.includeColors)?t._i(t.includeColors,null)>-1:t.includeColors},on:{change:function(s){var o=t.includeColors,n=s.target,a=!!n.checked;if(Array.isArray(o)){var r=null,l=t._i(o,r);n.checked?l<0&&(t.includeColors=o.concat([r])):l>-1&&(t.includeColors=o.slice(0,l).concat(o.slice(l+1)))}else t.includeColors=a}}}),e("div"),e("span",[t._v("Colors")])])]),e("div",{staticClass:"form-group mb8"},[e("label",{staticClass:"checkbox-control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.includeAudio,expression:"includeAudio"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.includeAudio)?t._i(t.includeAudio,null)>-1:t.includeAudio},on:{change:function(s){var o=t.includeAudio,n=s.target,a=!!n.checked;if(Array.isArray(o)){var r=null,l=t._i(o,r);n.checked?l<0&&(t.includeAudio=o.concat([r])):l>-1&&(t.includeAudio=o.slice(0,l).concat(o.slice(l+1)))}else t.includeAudio=a}}}),e("div"),e("span",[t._v("Audio")])])])])])},pt=[],mt=p(dt,ht,pt,!1,null,null,null,null);const ft=mt.exports;var vt=Object.defineProperty,gt=Object.getOwnPropertyDescriptor,_t=(i,t,e,s)=>{for(var o=s>1?void 0:s?gt(t,e):t,n=i.length-1,a;n>=0;n--)(a=i[n])&&(o=(s?a(t,e,o):a(o))||o);return s&&o&&vt(t,e,o),o};let x=class extends S{constructor(){super(...arguments);c(this,"paneId");c(this,"thresholds");c(this,"type");c(this,"rendering",!0);c(this,"dragging",null);c(this,"editing",null);c(this,"selectedThresholdId",null);c(this,"selectedSliderHandle",null);c(this,"thresholdPanelTrigger",null);c(this,"_dragReference",null);c(this,"movedAmount");c(this,"_minimum",null);c(this,"_maximum",null);c(this,"_offsetLeft",null);c(this,"_onStoreMutation");c(this,"_startDrag");c(this,"_endDrag");c(this,"_doDrag");c(this,"_doResize");c(this,"_width");c(this,"$refs")}get selectedThreshold(){return this.$store.getters[this.paneId+"/getThreshold"](this.selectedThresholdId)}get showThresholdsAsTable(){return this.$store.state.settings.showThresholdsAsTable}get useAudio(){return this.$store.state.settings.useAudio}get capToLastThreshold(){return this.thresholds[this.thresholds.length-1].max}get buyColor(){return this.thresholds[1].buyColor}get sellColor(){return this.thresholds[1].sellColor}created(){this._onStoreMutation=this.$store.subscribe(e=>{switch(e.type){case this.paneId+"/TOGGLE_SETTINGS_PANEL":case this.paneId+"/TOGGLE_THRESHOLDS_TABLE":(e.type===this.paneId+"/TOGGLE_SETTINGS_PANEL"&&e.payload==="thresholds"||e.type===this.paneId+"/TOGGLE_THRESHOLDS_TABLE"&&e.payload===!1)&&(this.rendering=!0,this.refreshHandlers(),this.refreshGradients());break;case this.paneId+"/SET_THRESHOLD_AMOUNT":case this.paneId+"/DELETE_THRESHOLD":case this.paneId+"/ADD_THRESHOLD":this.reorderThresholds(),this.refreshHandlers();break;case this.paneId+"/SET_THRESHOLD_COLOR":this.refreshGradients();break}})}mounted(){this.showThresholdsAsTable||(this.refreshHandlers(),this.refreshGradients()),this._startDrag=this.startDrag.bind(this),this.$el.addEventListener("touchstart",this._startDrag,!1),this.$el.addEventListener("mousedown",this._startDrag,!1),this._doDrag=this.doDrag.bind(this),window.addEventListener("touchmove",this._doDrag,!1),window.addEventListener("mousemove",this._doDrag,!1),this._endDrag=this.endDrag.bind(this),window.addEventListener("touchend",this._endDrag,!1),window.addEventListener("mouseup",this._endDrag,!1),this._doResize=this.refreshHandlers.bind(this),window.addEventListener("resize",this._doResize,!1)}beforeDestroy(){window.removeEventListener("touchmove",this._doDrag),window.removeEventListener("mousemove",this._doDrag),window.removeEventListener("touchend",this._endDrag),window.removeEventListener("mouseup",this._endDrag),window.removeEventListener("resize",this._doResize),this._onStoreMutation()}startDrag(e){if(!e.target.classList.contains("thresholds-slider__handler"))return;let s=e.pageX;e.touches&&e.touches.length&&(s=e.touches[0].pageX),this.selectThreshold(e.target.getAttribute("data-id"),e),this.selectedSliderHandle=e.target,this.$nextTick(()=>{this._dragReference={timestamp:Date.now(),position:s}})}selectThreshold(e,s){this.thresholdPanelTrigger&&this.selectedThresholdId===e||(this.selectedThresholdId=e,this.selectedThresholdId&&(this.thresholdPanelTrigger=s.target))}doDrag(e){let s=e.pageX;if(e.touches&&e.touches.length&&(s=e.touches[0].pageX),this.selectedSliderHandle===null||!this._dragReference||Date.now()-this._dragReference.timestamp<1e3&&Math.abs(this._dragReference.position-s)<3)return;this.dragging=!0;const n=Math.max(0,Math.log(this._minimum+1)||0)/Math.log(this._maximum+1)*this._width,a=Math.max(this._width/3*-1,Math.min(this._width*1.5,s-this._offsetLeft));let r=Math.exp((n+a/this._width*(this._width-n))/this._width*Math.log(this._maximum+1))-1;r<0&&(r=0),this.movedAmount=r,this.selectedSliderHandle.style.transform="translateX("+a+"px)"}endDrag(){this.selectedSliderHandle&&(this.selectedSliderHandle=null,this.reorderThresholds(),this.refreshHandlers(),this.refreshGradients(),typeof this.movedAmount=="number"&&this.$store.commit(this.paneId+"/SET_THRESHOLD_AMOUNT",{id:this.selectedThresholdId,value:this.movedAmount})),this.dragging=!1,this.movedAmount=null}async refreshHandlers(){await $(100);const e=this.thresholds.map(r=>r.amount);if(this._minimum=this.thresholds[0].amount,this._maximum=Math.max.apply(null,e),this.showThresholdsAsTable)return;const s=this.$refs.thresholdContainer.getBoundingClientRect();this._offsetLeft=s.left,this._width=this.$refs.thresholdContainer.clientWidth;const o=this.$refs.thresholdContainer.children,n=Math.max(0,Math.log(this._minimum+1)||0),a=Math.log(this._maximum+1)-n;for(let r=0;r<this.thresholds.length;r++){const l=o[r],m=this.thresholds[r],h=Math.log(m.amount+1)-n,d=this._width*(h/a);l.style.transform="translateX("+d+"px)"}this.rendering=!1}async refreshGradients(){if(this.showThresholdsAsTable)return;await $(100);const e=Math.max(0,Math.log(this._minimum+1)||0),s=Math.log(this._maximum+1),o=[],n=[];for(let a=0;a<this.thresholds.length;a++){const r=a===0?0:a===this.thresholds.length-1?100:((Math.log(this.thresholds[a].amount+1)-e)/(s-e)*100).toFixed(2);o.push(`${this.thresholds[a].buyColor} ${r}%`),n.push(`${this.thresholds[a].sellColor} ${r}%`)}this.$refs.buysGradient.style.backgroundImage=`linear-gradient(to right, ${o.join(", ")})`,this.$refs.sellsGradient.style.backgroundImage=`linear-gradient(to right, ${n.join(", ")})`}reorderThresholds(){this.thresholds.sort((e,s)=>e.amount-s.amount)}deleteThreshold(e){this.thresholds.length<=2||this.$store.commit(this.paneId+"/DELETE_THRESHOLD",e)}openThresholdAudio(e){f.open(it,{paneId:this.paneId,thresholds:this.thresholds,thresholdId:e})}formatAmount(e){return v(e)}flipSwatches(e){const s=`${e}Color`,o=this.thresholds.map(n=>n[s]).reverse();for(let n=0;n<this.thresholds.length;n++)this.$store.commit(this.paneId+"/SET_THRESHOLD_COLOR",{id:this.thresholds[n].id,side:s,value:o[n]})}toggleMaximumThreshold(e){this.$store.commit(this.paneId+"/TOGGLE_THRESHOLD_MAX",e.id)}async getPreset(){const e=await f.openAsPromise(ft);if(e){if(!e.amounts&&!e.audios&&!e.colors)return;const s=[];for(const o of this.thresholds){const n={};e.amounts&&(n.amount=o.amount),e.colors&&(n.buyColor=o.buyColor,n.sellColor=o.sellColor),e.audios&&(n.buyAudio=o.buyAudio,n.sellAudio=o.sellAudio),s.push(n)}return s}}applyPreset(e){let s=e?e.data:null;const o=JSON.parse(JSON.stringify(q[this.type]));let n=null,a=null,r=null;if(s){if(Array.isArray(s)||(s[this.type]&&Array.isArray(s[this.type])?s=s[this.type]:s.thresholds&&Array.isArray(s.thresholds)?s=s.thresholds:s=Object.keys(s).reduce((d,u)=>(isNaN(+u)||d.push(s[u]),d),[])),!s.length){this.$store.dispatch("app/showNotice",{title:"Preset looks empty",type:"error"});return}r=typeof s[0].amount<"u",n=typeof s[0].buyColor<"u",a=typeof s[0].buyAudio<"u";const m=r&&n&&a,h=o.length;if(m)C(this.$store.state[this.paneId][this.type],s);else{let d=this.$store.state[this.paneId][this.type][0].amount;this.$store.state[this.paneId][this.type]=C(this.$store.state[this.paneId][this.type],s).map((u,g)=>(u.id||(u.id=F()),typeof u.amount>"u"&&(u.amount=d),typeof u.buyColor>"u"&&(u.buyColor=o[Math.min(g,h)].buyColor,u.sellColor=o[Math.min(g,h)].sellColor),typeof u.buyAudio>"u"&&(u.buyAudio=o[Math.min(g,h)].buyAudio,u.sellAudio=o[Math.min(g,h)].sellAudio),d=u.amount,u))}}else r=n=a=!0,this.$store.state[this.paneId][this.type]&&this.$store.state[this.paneId][this.type].splice(0,this.$store.state[this.paneId][this.type].length),C(this.$store.state[this.paneId][this.type],o);const l=this.$store.state[this.paneId].thresholds[0];r&&this.$store.commit(this.paneId+"/SET_THRESHOLD_AMOUNT",{id:l.id,value:l.amount}),n&&this.$store.commit(this.paneId+"/SET_THRESHOLD_COLOR",{id:l.id,side:"buy",value:l.buyColor}),a&&this.$store.commit(this.paneId+"/SET_THRESHOLD_AUDIO",{id:l.id,buyAudio:l.buyAudio,sellAudio:l.sellAudio})}async regenerateSwatch(e,s){this.$store.dispatch(`${this.paneId}/generateSwatch`,{buyColor:e==="buy"&&s,sellColor:e==="sell"&&s,type:this.type,baseVariance:.15}),this.$store.state[this.paneId].thresholds=JSON.parse(JSON.stringify(this.$store.state[this.paneId].thresholds)),this.$store.commit(this.paneId+"/SET_THRESHOLD_COLOR",{id:this.thresholds[1].id,side:e,value:s})}};x=_t([E({name:"Thresholds",components:{ColorPickerControl:D,ThresholdDropdown:ut},props:{paneId:{type:String,required:!0},label:{type:String,default:null},thresholds:{required:!0},type:{type:String,default:"thresholds"}}})],x);var yt=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"thresholds",class:{"-dragging":t.dragging,"-rendering":t.rendering}},[e("div",{staticClass:"d-flex mx8"},[e("label",{staticClass:"column mlauto mrauto -center"},[e("small",{staticClass:"-fill -center mr8 text-right"},[t._v("Buy color")]),e("color-picker-control",{attrs:{value:t.buyColor,label:"Buy color"},on:{input:function(s){return t.regenerateSwatch("buy",s)}}})],1),e("label",{staticClass:"column mrauto mlauto -center"},[e("color-picker-control",{attrs:{value:t.sellColor,label:"Sell color"},on:{input:function(s){return t.regenerateSwatch("sell",s)}}}),e("small",{staticClass:"-fill -center ml8"},[t._v("Sell color")])],1)]),t.showThresholdsAsTable?e("table",{staticClass:"table thresholds-table"},[e("thead",[e("tr",[e("th",{attrs:{colspan:"2"}}),e("th",{staticClass:"table-action"},[e("button",{staticClass:"btn -text",on:{click:function(s){return t.flipSwatches("buy")}}},[t._v("flip")])]),e("th",{staticClass:"table-action"},[e("button",{staticClass:"btn -text",on:{click:function(s){return t.flipSwatches("sell")}}},[t._v(" flip ")])])])]),e("transition-group",{attrs:{name:"flip-list",tag:"tbody"}},t._l(t.thresholds,function(s,o){return e("tr",{key:s.id},[e("td",{staticClass:"table-input table-min"},[o===t.thresholds.length-1?e("label",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"checkbox-control -extra-small mb4",attrs:{title:"Set as maximum amount"}},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.capToLastThreshold},on:{change:function(n){return t.toggleMaximumThreshold(s)}}}),e("div")]):t._e()]),e("td",{staticClass:"table-input"},[e("div",{staticClass:"thresholds-table__threshold"},[e("i",{staticClass:"icon icon-currency"}),e("editable",{staticClass:"w-100",attrs:{placeholder:"Amount*",value:t.formatAmount(s.amount)},on:{input:function(n){return t.$store.commit(t.paneId+"/SET_THRESHOLD_AMOUNT",{id:s.id,value:n})}}}),o===t.thresholds.length-1&&s.max?e("small",{staticClass:"text-danger",attrs:{title:"Will only show trades below that amount"}},[e("strong",[t._v("MAX")])]):t._e()],1)]),e("td",{staticClass:"table-action"},[e("color-picker-control",{attrs:{label:"Buy color",value:s.buyColor},on:{input:function(n){return t.$store.commit(t.paneId+"/SET_THRESHOLD_COLOR",{id:s.id,side:"buyColor",value:n})}}})],1),e("td",{staticClass:"table-action"},[e("color-picker-control",{attrs:{label:"Sell color",value:s.sellColor},on:{input:function(n){return t.$store.commit(t.paneId+"/SET_THRESHOLD_COLOR",{id:s.id,side:"sellColor",value:n})}}})],1),t.useAudio?e("td",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"thresholds-table__audio table-action",attrs:{title:"Configure threshold audio"},on:{click:function(n){return t.openThresholdAudio(s.id)}}},[e("button",{staticClass:"btn -text"},[e("i",{staticClass:"icon-music-note"})])]):t._e(),e("td",{staticClass:"table-action",on:{click:function(n){return t.selectThreshold(s.id,n)}}},[e("button",{staticClass:"btn -text"},[e("i",{staticClass:"icon-more"})])])])}),0)],1):e("div",{staticClass:"thresholds-slider"},[e("div",{staticClass:"thresholds-gradients"},[e("div",{ref:"buysGradient",staticClass:"thresholds-gradients__buys"}),e("div",{ref:"sellsGradient",staticClass:"thresholds-gradients__sells"})]),e("div",{ref:"thresholdContainer",staticClass:"thresholds-slider__bar"},t._l(t.thresholds,function(s){return e("div",{key:s.id,staticClass:"thresholds-slider__handler",class:{"-selected":t.selectedThresholdId===s.id},attrs:{"data-id":s.id,"data-amount":t.formatAmount(s.amount,2)}})}),0)]),e("div",{staticClass:"d-flex mt8"},[e("presets",{staticClass:"mrauto",attrs:{type:"threshold",placeholder:"Custom thresholds",adapter:t.getPreset,classes:"btn -green -small -center"},on:{apply:function(s){return t.applyPreset(s)}}}),e("button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn -nowrap -text -start",attrs:{type:"button",title:"Add a threshold"},on:{click:function(s){return t.$store.commit(t.paneId+"/ADD_THRESHOLD",t.type)}}},[e("i",{staticClass:"icon-plus"})])],1),e("dropdown",{attrs:{interactive:""},model:{value:t.thresholdPanelTrigger,callback:function(s){t.thresholdPanelTrigger=s},expression:"thresholdPanelTrigger"}},[e("threshold-dropdown",{attrs:{threshold:t.selectedThreshold,"pane-id":t.paneId,"can-delete":t.thresholds.length>2},on:{input:function(s){t.thresholdPanelTrigger=s}}})],1)],1)},bt=[],Ct=p(x,yt,bt,!1,null,null,null,null);const Tt=Ct.exports;var At=Object.defineProperty,xt=Object.getOwnPropertyDescriptor,wt=(i,t,e,s)=>{for(var o=s>1?void 0:s?xt(t,e):t,n=i.length-1,a;n>=0;n--)(a=i[n])&&(o=(s?a(t,e,o):a(o))||o);return s&&o&&At(t,e,o),o};let w=class extends S{constructor(){super(...arguments);c(this,"paneId");c(this,"secondsAgoExample","0s ago");c(this,"_secondsAgoExampleTimeout")}get HHMM(){return new Date().toISOString().split("T")[1].split(":").slice(0,2).join(":")}get useAudio(){return this.$store.state.settings.useAudio}get markets(){return this.$store.state.panes.panes[this.paneId].markets}get maxRows(){return this.$store.state[this.paneId].maxRows}get thresholds(){return this.$store.state[this.paneId].thresholds}get liquidations(){return this.$store.state[this.paneId].liquidations}get showLogos(){return this.$store.state[this.paneId].showLogos}get monochromeLogos(){return this.$store.state[this.paneId].monochromeLogos}get showTimeAgo(){return this.$store.state[this.paneId].showTimeAgo}get showPrices(){return this.$store.state[this.paneId].showPrices}get showTrades(){return this.$store.state[this.paneId].showTrades}get showLiquidations(){return this.$store.state[this.paneId].showLiquidations}get showPairs(){return this.$store.state[this.paneId].showPairs}get showHistograms(){return this.$store.state[this.paneId].showHistograms}get audioThreshold(){return this.$store.state[this.paneId].audioThreshold}get muted(){return this.$store.state[this.paneId].muted}get audioPitch(){return this.$store.state[this.paneId].audioPitch||1}get audioVolume(){const e=this.$store.state[this.paneId].audioVolume;return e===null?this.$store.state.settings.audioVolume:e}get thresholdsMultipler(){return this.$store.state[this.paneId].thresholdsMultipler}get disableAnimations(){return this.$store.state.settings.disableAnimations}get isLegacy(){return this.$store.state.panes.panes[this.paneId].type==="trades"}get displayGifWarning(){return this.isLegacy&&this.disableAnimations&&(this.thresholds.filter(e=>!!e.buyGif&&!!e.sellGif).length||this.liquidations.filter(e=>!!e.buyGif&&!!e.sellGif).length)}get multipliers(){return this.markets.map(e=>{const[s,o]=j(e),n=this.$store.state[this.paneId].multipliers[e];return{exchange:s,pair:o,multiplier:isNaN(n)?1:n,identifier:e}})}get mutipliersCount(){return this.multipliers.filter(e=>e.multiplier!==1).length}get gradient(){return[this.$store.state[this.paneId].thresholds[0].buyColor,this.$store.state[this.paneId].thresholds[this.$store.state[this.paneId].thresholds.length-1].buyColor]}mounted(){const e=Date.now();this._secondsAgoExampleTimeout=setInterval(()=>{this.secondsAgoExample=`${z(e)} ago`},1e3)}beforeDestroy(){this._secondsAgoExampleTimeout&&clearTimeout(this._secondsAgoExampleTimeout)}formatAmount(e){return v(e)}};w=wt([E({components:{Thresholds:Tt,Slider:I,ToggableSection:U},name:"TradesSettings",props:{paneId:{type:String,required:!0}}})],w);var Et=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",[e("div",{staticClass:"form-group mb16"},[e("div",{staticClass:"column"},[e("div",[t._v("←")]),e("small",[t._v("Small orders")]),e("slider",{staticClass:"mt8 -fill -start",attrs:{min:.01,max:10,step:.01,"show-completion":!1,value:t.thresholdsMultipler,gradient:t.gradient,log:""},on:{input:function(s){return t.$store.commit(t.paneId+"/SET_THRESHOLDS_MULTIPLER",{value:s,market:t.markets[0]})},reset:function(s){return t.$store.commit(t.paneId+"/SET_THRESHOLDS_MULTIPLER",{value:1,market:t.markets[0]})}}}),e("small",{staticClass:"text-left mlauto"},[t._v("Large orders")]),e("div",[t._v("→")])],1)]),e("br"),e("ToggableSection",{attrs:{title:"Thresholds",id:"trades-thresholds",badge:t.thresholds.length,disabled:!t.showTrades,inset:""}},[e("div",{staticClass:"form-group"},[e("thresholds",{attrs:{paneId:t.paneId,thresholds:t.thresholds,label:"Trades",type:"thresholds"}})],1),t.displayGifWarning?e("div",{staticClass:"d-flex help-text"},[e("p",{staticClass:"mt0 mb0 text-success"},[e("i",{staticClass:"icon-info mr8"}),e("a",{attrs:{href:"javascript:void(0);"},on:{click:function(s){return t.$store.commit("settings/TOGGLE_ANIMATIONS")}}},[t._v("Enable animations to show gifs")])])]):t._e()]),e("ToggableSection",{attrs:{title:"Liquidations",id:"trades-liquidations",badge:t.liquidations.length,disabled:!t.showLiquidations,inset:""}},[e("div",{staticClass:"form-group"},[e("thresholds",{attrs:{paneId:t.paneId,thresholds:t.liquidations,label:"Liquidations",type:"liquidations"}})],1),t.displayGifWarning?e("div",{staticClass:"d-flex help-text"},[e("p",{staticClass:"mt0 mb0 text-success"},[e("i",{staticClass:"icon-info mr8"}),e("a",{attrs:{href:"javascript:void(0);"},on:{click:function(s){return t.$store.commit("settings/TOGGLE_ANIMATIONS")}}},[t._v("Enable animations to show gifs")])])]):t._e()]),e("ToggableSection",{attrs:{title:"Audio",id:"trades-audio",inset:""}},[e("div",{staticClass:"column mb16"},[e("div",{staticClass:"form-group text-nowrap"},[e("label",{staticClass:"checkbox-control"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox",disabled:!t.useAudio},domProps:{checked:t.muted},on:{change:function(s){return t.$store.commit(t.paneId+"/TOGGLE_MUTED")}}}),e("div"),e("span",[t._v("Mute pane")])])]),e("div",{staticClass:"-fill ml16"},[e("label",{staticClass:"mt8 d-block text-color-base"},[t._v("Pane volume")]),e("div",{staticClass:"column"},[e("slider",{staticClass:"mrauto -fill mt8 mb8",attrs:{min:0,max:400,step:1,label:!0,disabled:t.muted,value:t.audioVolume*100,log:""},on:{input:function(s){t.$store.commit(t.paneId+"/SET_AUDIO_VOLUME",+(s/100).toFixed(2))},reset:function(s){return t.$store.commit(t.paneId+"/SET_AUDIO_VOLUME",null)}},scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v(" "+t._s(t.audioVolume>1?"+":"")+" "+t._s(+(t.audioVolume*100).toFixed(2))+"% ")]},proxy:!0}])}),e("editable",{staticClass:"-center text-nowrap ml8",staticStyle:{"line-height":"1"},attrs:{value:"× "+t.audioVolume},on:{input:function(s){return t.$store.commit(t.paneId+"/SET_AUDIO_VOLUME",s)}}})],1),e("label",{staticClass:"mt16 d-block text-color-base"},[t._v("Transpose")]),e("div",{staticClass:"column"},[e("slider",{staticClass:"mrauto -fill mt8 mb8",attrs:{min:.001,max:5,step:.01,showCompletion:!1,disabled:t.muted,value:t.audioPitch,log:""},on:{input:function(s){return t.$store.commit(t.paneId+"/SET_AUDIO_PITCH",s)},reset:function(s){return t.$store.commit(t.paneId+"/SET_AUDIO_PITCH",null)}},scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v("× "+t._s(t.audioPitch)+" ")]},proxy:!0}])}),e("editable",{staticClass:"-center text-nowrap ml8",staticStyle:{"line-height":"1"},attrs:{value:"× "+t.audioPitch},on:{input:function(s){return t.$store.commit(t.paneId+"/SET_AUDIO_PITCH",s)}}})],1)])]),t.useAudio&&!t.muted?e("div",{staticClass:"form-group"},[e("label",[t._v(" Minimum for a trade to trigger a sound "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info mr8",attrs:{title:"Enter the absolute amount<br>or % of significant amount"}})]),e("editable",{staticClass:"form-control",attrs:{value:t.audioThreshold,placeholder:"10%"},on:{input:function(s){return t.$store.commit(t.paneId+"/SET_AUDIO_THRESHOLD",s)}}})],1):t._e(),t.useAudio?t._e():e("button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn -text -small -cases",attrs:{type:"button",title:"Click to enable audio"},on:{click:function(s){return t.$store.commit("settings/TOGGLE_AUDIO",!0)}}},[e("i",{staticClass:"icon-info mr8 -lower"}),t._v("Audio is currently disabled ")])]),e("ToggableSection",{attrs:{title:"Preferences",id:"trades-display",inset:""}},[e("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{boundary:"window",placement:"left"},expression:"{ boundary: 'window', placement: 'left' }"}],staticClass:"form-group column mb8",attrs:{title:"Number of trades rendered"}},[e("label",{staticClass:"-fill -center -inline"},[t._v("Lines count")]),e("input",{staticClass:"form-control",attrs:{id:"trades-limit",type:"number",min:"0",max:"1000",step:"1"},domProps:{value:t.maxRows},on:{change:function(s){return t.$store.commit(t.paneId+"/SET_MAX_ROWS",s.target.value)}}})]),e("div",{staticClass:"form-group column mb8",on:{click:function(s){return s.stopPropagation(),t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showTrades")}}},[e("label",{staticClass:"-fill -center -inline"},[t._v("Show trades")]),e("div",{staticClass:"checkbox-control checkbox-control-input -unshrinkable",on:{click:function(s){s.stopPropagation()}}},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.showTrades}}),e("div",{on:{click:function(s){return t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showTrades")}}})])]),e("div",{staticClass:"form-group column mb8",on:{click:function(s){return s.stopPropagation(),t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showLiquidations")}}},[e("label",{staticClass:"-fill -center -inline"},[t._v("Show liquidations")]),e("div",{staticClass:"checkbox-control checkbox-control-input -unshrinkable",on:{click:function(s){s.stopPropagation()}}},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.showLiquidations}}),e("div",{on:{click:function(s){return t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showLiquidations")}}})])]),t.isLegacy?e("div",{staticClass:"form-group column mb8",on:{click:function(s){return s.stopPropagation(),t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showLogos")}}},[e("label",{staticClass:"-fill -center -inline"},[t._v("Show logos")]),e("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"checkbox-control checkbox-control-input -unshrinkable",attrs:{title:"Exchange's logos + style"},on:{click:function(s){s.stopPropagation()}}},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.showLogos}}),e("div",{on:{click:function(s){return t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showLogos")}}})])]):t._e(),t.showLogos&&t.isLegacy?e("div",{staticClass:"form-group column mb8",on:{click:function(s){return s.stopPropagation(),t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","monochromeLogos")}}},[e("label",{staticClass:"-fill -center -inline"},[t._v("Monochrome logos")]),e("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"checkbox-control checkbox-control-input -unshrinkable",attrs:{title:"Exchange's logos + style"},on:{click:function(s){s.stopPropagation()}}},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.monochromeLogos}}),e("div",{on:{click:function(s){return t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","monochromeLogos")}}})])]):t._e(),e("div",{staticClass:"form-group column mb8",on:{click:function(s){return s.stopPropagation(),t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showPairs")}}},[e("label",{staticClass:"-fill -center -inline"},[t._v("Show pairs")]),e("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"checkbox-control checkbox-control-input -unshrinkable",attrs:{title:"Show symbol's names<br>(ex: BTC-USD)"},on:{click:function(s){s.stopPropagation()}}},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.showPairs}}),e("div",{on:{click:function(s){return t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showPairs")}}})])]),e("div",{staticClass:"form-group column mb8",on:{click:function(s){return s.stopPropagation(),t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showPrices")}}},[e("label",{staticClass:"-fill -center -inline"},[t._v("Show prices")]),e("div",{staticClass:"checkbox-control checkbox-control-input -unshrinkable",on:{click:function(s){s.stopPropagation()}}},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.showPrices}}),e("div",{on:{click:function(s){return t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showPrices")}}})])]),t.isLegacy?e("div",{staticClass:"form-group column",on:{click:function(s){return s.stopPropagation(),t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showTimeAgo")}}},[e("label",{staticClass:"-fill -center -inline"},[t._v("Time format")]),e("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"checkbox-control -auto checkbox-control-input -unshrinkable",attrs:{title:"Time format preference"}},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.showTimeAgo}}),e("div",{attrs:{on:t.secondsAgoExample,off:t.HHMM}})])]):t._e(),t.isLegacy?t._e():e("div",{staticClass:"form-group column mb8",on:{click:function(s){return s.stopPropagation(),t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showHistograms")}}},[e("label",{staticClass:"-fill -center -inline"},[t._v("Histogram")]),e("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"checkbox-control checkbox-control-input",attrs:{title:"Rolling delta histogram"},on:{click:function(s){s.stopPropagation()}}},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.showHistograms}}),e("div",{on:{click:function(s){return t.$store.commit(t.paneId+"/TOGGLE_PREFERENCE","showHistograms")}}})])])]),t.isLegacy?e("ToggableSection",{attrs:{title:"THRESHOLD MULTIPLIER",inset:""}},[t.multipliers.length?e("div",{staticClass:"form-group"},[e("label",[e("div",{staticClass:"d-flex"},[e("div",[t._v(" ← Decrease threshold"),e("br"),e("small",[t._v("← Increase visibility")])]),e("div",{staticClass:"text-right mlauto"},[t._v(" Increase threshold →"),e("br"),e("small",[t._v("Decrease visibility →")])])])]),e("div",{staticClass:"multipliers"},t._l(t.multipliers,function(s){return e("div",{key:s.identifier,staticClass:"d-flex multipliers-market",class:{"-disabled":s.multiplier===1}},[e("div",{staticClass:"multipliers-market__id",on:{dblclick:function(o){return t.$store.commit(t.paneId+"/SET_THRESHOLD_MULTIPLIER",{identifier:s.identifier,multiplier:null})}}},[e("div",{staticClass:"text-nowrap market-exchange"},[e("small",[t._v(t._s(s.exchange))])]),e("div",{staticClass:"text-nowrap market-pair"},[t._v(" "+t._s(s.pair)+" ")])]),e("div",{staticClass:"-fill -center ml16"},[e("slider",{staticStyle:{width:"100%","min-width":"150px"},attrs:{min:0,max:2,label:s.multiplier!==1,step:.01,showCompletion:!1,value:s.multiplier,editable:!1},on:{input:function(o){return t.$store.commit(t.paneId+"/SET_THRESHOLD_MULTIPLIER",{identifier:s.identifier,multiplier:o})},reset:function(o){return t.$store.commit(t.paneId+"/SET_THRESHOLD_MULTIPLIER",{identifier:s.identifier,multiplier:1})}},scopedSlots:t._u([{key:"tooltip",fn:function({value:o}){return[t._v(" "+t._s(t.thresholds[0].amount*o)+" ")]}}],null,!0)})],1)])}),0)]):e("p",{staticClass:"mb0"},[t._v(" No active markets, "),e("a",{attrs:{href:"javascript:void(0);"},on:{click:function(s){return t.$store.dispatch("app/showSearch",{paneId:t.paneId})}}},[t._v(" add markets")]),t._v(". ")])]):t._e()],1)},St=[],$t=p(w,Et,St,!1,null,"a196c248",null,null);const It=$t.exports,kt={components:{TradesSettings:It},mixins:[_,V]};var Lt=function(){var t=this,e=t._self._c;return e("Dialog",{staticClass:"pane-dialog",attrs:{size:"medium"},on:{clickOutside:t.close},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",{staticClass:"dialog__title -editable",domProps:{textContent:t._s(t.name)},on:{dblclick:t.renamePane}}),e("div",{staticClass:"column -center"})]},proxy:!0},{key:"footer",fn:function(){return[e("presets",{staticClass:"-left -top",attrs:{type:"trades",adapter:t.getPreset,placeholder:t.paneId},on:{apply:function(s){return t.resetPane(s)}}})]},proxy:!0}])},[e("trades-settings",{attrs:{paneId:t.paneId}})],1)},Dt=[],Ot=p(kt,Lt,Dt,!1,null,null,null,null);const qt=Ot.exports;export{qt as default};

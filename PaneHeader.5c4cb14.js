var m=Object.defineProperty;var g=(a,t,e)=>t in a?m(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var r=(a,t,e)=>(g(a,typeof t!="symbol"?t+"":t,e),e);import{C as h,V as u,B as f,d as c,ai as _,A as b,F as y,n as w}from"./index.5c4cb14.js";var v=Object.defineProperty,P=Object.getOwnPropertyDescriptor,C=(a,t,e,s)=>{for(var n=s>1?void 0:s?P(t,e):t,i=a.length-1,o;i>=0;i--)(o=a[i])&&(n=(s?o(t,e,n):o(n))||n);return s&&n&&v(t,e,n),n};let d=class extends u{constructor(){super(...arguments);r(this,"paneId");r(this,"_onStoreMutation")}get pane(){return this.$store.state.panes.panes[this.paneId]}mounted(){this.$el.id=this.paneId,this.refreshZoom(),this.$nextTick(()=>{const t=this.$el.clientWidth;typeof this.onResize=="function"&&this.onResize(t,this.$el.clientHeight,!0)}),this.$el.addEventListener("mousedown",this.focusPane)}beforeDestroy(){this.$el.removeEventListener("mousedown",this.focusPane),this._onStoreMutation&&this._onStoreMutation()}refreshZoom(){this.$store.dispatch("panes/refreshZoom",{id:this.paneId})}focusPane(){this.$store.commit("app/SET_FOCUSED_PANE",this.paneId)}};d=C([h({props:{paneId:{required:!0,type:String}}})],d);var $=Object.defineProperty,x=Object.getOwnPropertyDescriptor,I=(a,t,e,s)=>{for(var n=s>1?void 0:s?x(t,e):t,i=a.length-1,o;i>=0;i--)(o=a[i])&&(n=(s?o(t,e,n):o(n))||n);return s&&n&&$(t,e,n),n};let l=class extends u{constructor(){super(...arguments);r(this,"settings");r(this,"paneId");r(this,"paneDropdownTrigger",null);r(this,"isLoading",!1)}get zoom(){return this.$store.state.panes.panes[this.paneId].zoom||1}get type(){return this.$store.state.panes.panes[this.paneId].type}get name(){const e=this.$store.state.panes.panes[this.paneId].name,s=this.$store.state.panes.marketsListeners[this.$store.state.panes.panes[this.paneId].markets[0]];return e?e.trim():s?s.local:this.type}openSearch(){this.$store.dispatch("app/showSearch",{paneId:this.paneId})}changeZoom(e,s){const n=this.zoom+(e.shiftKey?.0625:.125)*s;this.$store.dispatch("panes/setZoom",{id:this.paneId,zoom:n}),this.$emit("zoom",n)}resetZoom(){this.$store.dispatch("panes/setZoom",{id:this.paneId,zoom:1}),this.$emit("zoom",1)}async removePane(){await c.confirm(`Delete pane ${this.type} "${this.name}" ?`)&&this.$store.dispatch("panes/removePane",this.paneId)}duplicatePane(){this.$store.dispatch("panes/duplicatePane",this.paneId)}maximizePane(e){if(e.type==="dblclick"&&e.currentTarget!==e.target)return;const s=this.$el.parentElement.parentElement,n=s.classList.toggle("-maximized"),i=_(s);for(const p of i)p.getAttribute("type")&&(p.classList.remove("-maximized"),p.style.display=n?"none":"block");const o=Event;window.dispatchEvent(new o("resize")),this.$store.dispatch("panes/setZoom",{id:this.paneId,zoom:n?this.zoom*1.5:this.zoom*(2/3)})}async renamePane(e){e&&e.stopPropagation();const s=await c.prompt({placeholder:"Main pane's market",action:"Rename",input:this.name});typeof s=="string"&&s!==this.name&&this.$store.commit("panes/SET_PANE_NAME",{id:this.paneId,name:s})}async downloadPane(){const e=`${this.type}:${this.paneId}`;b({name:e,type:this.type,data:this.$store.state[this.paneId],markets:this.$store.state.panes.panes[this.paneId].markets,createdAt:Date.now(),updatedAt:null},y(`${this.type} ${this.name}`))}toggleDropdown(e){this.paneDropdownTrigger?this.paneDropdownTrigger=null:this.paneDropdownTrigger=e.currentTarget}async openSettings(){this.settings&&(this.isLoading=!0,c.open((await this.settings()).default,{paneId:this.paneId}),this.isLoading=!1)}};l=I([h({name:"PaneHeader",props:{paneId:{type:String},settings:{type:Function,default:null},showSearch:{type:Boolean,default:!0},showName:{type:Boolean,default:!0},split:{type:Boolean,default:!0}},components:{Btn:f}})],l);var z=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"pane-header hide-scrollbar d-flex",class:[t.split&&"pane-header--split"],on:{dblclick:t.maximizePane}},[t.showName&&t.name?e("div",{staticClass:"btn -cases pane-header__highlight",on:{dblclick:t.maximizePane}},[t._t("title",function(){return[t._v(" "+t._s(t.name)+" "),e("btn",{staticClass:"pane-header__edit btn -text -small",attrs:{type:"button"},on:{click:t.renamePane}},[e("i",{staticClass:"icon-edit"})])]})],2):t._e(),t._t("default",function(){return[e("hr")]}),t.showSearch?e("button",{staticClass:"btn -text",attrs:{type:"button"},on:{click:t.openSearch}},[e("i",{staticClass:"icon-search"})]):t._e(),t.settings?e("btn",{staticClass:"pane-overlay -text",attrs:{type:"button",loading:t.isLoading},on:{click:t.openSettings}},[e("i",{staticClass:"icon-cog"})]):t._e(),e("button",{staticClass:"pane-overlay btn -text",attrs:{type:"button"},on:{click:t.toggleDropdown}},[e("i",{staticClass:"icon-more"})]),e("dropdown",{model:{value:t.paneDropdownTrigger,callback:function(s){t.paneDropdownTrigger=s},expression:"paneDropdownTrigger"}},[e("div",{staticClass:"d-flex btn-group"},[e("button",{staticClass:"btn -green",attrs:{type:"button"},on:{click:function(s){return s.stopPropagation(),t.changeZoom(s,-1)}}},[e("i",{staticClass:"icon-minus"})]),e("button",{staticClass:"btn -green text-monospace flex-grow-1 text-center",attrs:{type:"button"},on:{click:function(s){return s.stopPropagation(),t.resetZoom.apply(null,arguments)}}},[t._v(" Ã— "+t._s(t.zoom.toFixed(2))+" ")]),e("button",{staticClass:"btn -green",attrs:{type:"button"},on:{click:function(s){return s.stopPropagation(),t.changeZoom(s,1)}}},[e("i",{staticClass:"icon-plus"})])]),t.settings!==null?e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.openSettings}},[e("i",{staticClass:"icon-cog"}),e("span",[t._v("Settings")])]):t._e(),t.showSearch?e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.openSearch}},[e("i",{staticClass:"icon-search"}),e("span",[t._v("Sources")])]):t._e(),t.$slots.menu?e("div",{staticClass:"dropdown-divider",attrs:{"data-label":`${t.paneId} options`}}):t._e(),t._t("menu"),e("div",{staticClass:"dropdown-divider",attrs:{"data-label":"utilities"}}),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.maximizePane}},[e("i",{staticClass:"icon-enlarge"}),e("span",[t._v("Maximize")])]),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.duplicatePane}},[e("i",{staticClass:"icon-copy-paste"}),e("span",[t._v("Duplicate")])]),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.downloadPane}},[e("i",{staticClass:"icon-download"}),e("span",[t._v("Download")])]),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.renamePane}},[e("i",{staticClass:"icon-edit"}),e("span",[t._v("Rename")])]),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.removePane}},[e("i",{staticClass:"icon-trash"}),e("span",[t._v("Remove")])])],2)],2)},S=[],D=w(l,z,S,!1,null,null,null,null);const Z=D.exports;export{d as P,Z as a};

var p=Object.defineProperty;var d=(i,e,t)=>e in i?p(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var n=(i,e,t)=>(d(i,typeof e!="symbol"?e+"":e,t),t);import{C as m,t as f,ak as h,V as g,z as S,a6 as c,n as _}from"./index.5c4cb14.js";import{T as v}from"./ToggableGroup.5c4cb14.js";var C=Object.defineProperty,y=Object.getOwnPropertyDescriptor,b=(i,e,t,s)=>{for(var r=s>1?void 0:s?y(e,t):e,o=i.length-1,a;o>=0;o--)(a=i[o])&&(r=(s?a(e,t,r):a(r))||r);return s&&r&&C(e,t,r),r};let u,l=class extends g{constructor(){super(...arguments);n(this,"helps",{"notifications-disabled":"Push notification are disabled.","notifications-grant":"Enable notifications for this site in your browser."});n(this,"notificationsPermissionState","granted")}get alertSound(){return this.$store.state.settings.alertSound}get alerts(){return this.$store.state.settings.alerts}get alertsColor(){return this.$store.state.settings.alertsColor}get alertsLineStyle(){return this.$store.state.settings.alertsLineStyle}get alertsLineWidth(){return this.$store.state.settings.alertsLineWidth}get alertsClick(){return this.$store.state.settings.alertsClick}get displayAlertSound(){const t=this.alertSound;return t?t.length<=14?t:t.slice(0,6)+".."+t.substr(-6):null}created(){this.checkNotificationsPermission()}checkNotificationsPermission(){navigator.permissions.query({name:"notifications"}).then(t=>{u||(t.onchange=s=>{this.setNotificationsPermission(s.target.state)},u=t),this.setNotificationsPermission(t.state)}).catch(t=>{console.error(t.message)})}setNotificationsPermission(t){this.notificationsPermissionState=t,this.notificationsPermissionState!=="granted"&&this.alerts&&this.$store.commit("settings/TOGGLE_ALERTS",!1)}async toggleAlerts(t){let s=t.target.checked;s&&(this.notificationsPermissionState=await Notification.requestPermission()),this.notificationsPermissionState==="denied"&&s?(s=!1,this.$store.dispatch("app/showNotice",{id:"alert-notifications",type:"error",icon:"icon-warning -large pt0",timeout:1e5,html:!0,title:`<div class="ml8"><strong>This might not work as expected.</strong><br>${this.helps["notifications-grant"]}</div>`})):this.$store.dispatch("app/showNotice",{id:"alert-notifications",type:"info",title:s?"Alerts are enabled":"Alerts are disabled"}),t.target.checked=s,this.$store.commit("settings/TOGGLE_ALERTS",s)}async handleAlertSoundFile(t){const s=t.target.files[0];if(s)try{await S.importSound(s),this.$store.commit("settings/SET_ALERT_SOUND",s.name),c.playOnce(s.name)}catch(r){this.$store.dispatch("app/showNotice",{title:r.message,type:"error"});return}}removeAlertSound(){this.alertSound&&this.$store.commit("settings/SET_ALERT_SOUND",null)}async playAlertSound(){if(this.alertSound)try{await c.playOnce(this.alertSound,3e3)}catch(t){console.error(t),this.$store.dispatch("app/showNotice",{type:"error",title:`Failed to play ${this.alertSound}`})}}};l=b([m({components:{DropdownButton:f,ToggableGroup:v,ColorPickerControl:h},name:"AlertsSettings"})],l);var A=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("toggable-group",{staticClass:"alerts-settings",attrs:{value:e.alerts,label:"Price alerts"},on:{change:function(s){return e.toggleAlerts(s)}},scopedSlots:e._u([{key:"off",fn:function(){return[e.notificationsPermissionState==="denied"?t("label",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"text-danger help-text mt0 mb0",attrs:{title:`${e.helps["notifications-disabled"]} ${e.helps["notifications-grant"]}`}},[t("i",{staticClass:"icon-warning mr4"}),e._v(" Notifications are blocked. ")]):e.notificationsPermissionState!=="granted"?t("p",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"text-info help-text mt0 mb0",attrs:{title:`${e.helps["notifications-disabled"]} ${e.helps["notifications-grant"]}`}},[t("i",{staticClass:"icon-info mr4"}),e._v(" Awaiting browser persmission. ")]):e._e()]},proxy:!0}])},[t("p",{staticClass:"mt0 text-color-50"},[t("i",{staticClass:"icon-info"}),e._v(" Uses average price of the coin ")]),t("div",{staticClass:"column"},[t("div",{staticClass:"form-group"},[t("label",[e._v("Line style")]),t("dropdown-button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"-outline form-control -arrow flex-grow-1 w-100",attrs:{value:e.alertsLineStyle,options:{0:"Solid",1:"Dotted",2:"Dashed",3:"LargeDashed",4:"SparseDotted"},placeholder:"lineStyle",title:"Line style (ex: dashed)"},on:{input:function(s){return e.$store.commit("settings/SET_ALERTS_LINESTYLE",s)}}})],1),t("div",{staticClass:"form-group"},[t("label",[e._v("Line width")]),t("editable",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"form-control -center w-100",attrs:{value:e.alertsLineWidth,title:"Line width (ex: 2)"},on:{input:function(s){return e.$store.commit("settings/SET_ALERTS_LINEWIDTH",s)}}})],1),t("div",{staticClass:"form-group"},[t("label",[e._v("Color")]),t("color-picker-control",{attrs:{value:e.alertsColor,label:"Alert color"},on:{input:function(s){return e.$store.commit("settings/SET_ALERTS_COLOR",s)}}})],1)]),t("div",{staticClass:"column"},[t("div",{staticClass:"form-group mb16 mt16"},[t("label",[t("i",{staticClass:"icon-click mr4"}),e._v(" Control")]),t("label",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"checkbox-control d-flex -aggr -auto -auto",attrs:{title:"Place alerts faster ⚡️"},on:{change:function(s){return e.$store.commit("settings/TOGGLE_ALERTS_CLICK")}}},[t("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:e.alertsClick}}),t("div",{attrs:{on:"1 CLICK ⚡️",off:"ALT+CLICK"}})])]),t("div",{staticClass:"form-group mt16 mb16"},[t("label",{attrs:{for:"audio-assistant-source"}},[t("i",{staticClass:"icon-music-note mr4"}),e._v(" Alert sound")]),t("button",{staticClass:"btn -file -blue -cases"},[t("i",{staticClass:"icon-upload mr8"}),e._v(" "+e._s(e.displayAlertSound||"Browse")+" "),e.alertSound?t("i",{staticClass:"icon-volume-high mr8 btn__suffix",on:{click:function(s){return s.stopPropagation(),s.preventDefault(),e.playAlertSound.apply(null,arguments)}}}):e._e(),e.alertSound?t("i",{staticClass:"icon-cross mr8 btn__suffix",on:{click:function(s){return s.stopPropagation(),s.preventDefault(),e.removeAlertSound.apply(null,arguments)}}}):e._e(),t("input",{staticClass:"input-file",attrs:{type:"file",accept:"audio/*"},on:{change:e.handleAlertSoundFile}})])])])])},L=[],w=_(l,A,L,!1,null,null,null,null);const N=w.exports;export{N as A};

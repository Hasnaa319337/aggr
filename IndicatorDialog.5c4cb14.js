var b=Object.defineProperty;var O=(s,t,i)=>t in s?b(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i;var d=(s,t,i)=>(O(s,typeof t!="symbol"?t+"":t,i),i);import{n as m,D as g,W as _,C,_ as l,V as T,t as w,T as x,u as y,d as p,v as S,c as k}from"./index.5c4cb14.js";import{T as K,a as $}from"./Tab.5c4cb14.js";import{g as f,A as P,a as E,b as N,d as h,p as D,c as A,e as V}from"./options.5c4cb14.js";const L={mixins:[g],props:{plotTypes:{type:Array,required:!0},keys:{type:Array,required:!0},originalKeys:{type:Array,default:null}},data(){return{selection:this.keys.reduce((s,t)=>(s[t]=!!(this.originalKeys&&this.originalKeys.indexOf(t)!==-1),s),{}),form:{colors:!1,values:!0,script:!1}}},computed:{count(){return Object.values(this.selection).reduce((s,t)=>(t&&s++,s),this.form.script?1:0)},submitLabel(){if(!this.count)return"No selection";const s=this.form.script?1:0,t=this.count-s,i=[];return t&&i.push(`${t} option${t>1?"s":""}`),s&&i.push("the code"),i.join(" + ")}},mounted(){this.originalKeys||(this.form.colors=!0,this.toggleType(!0,!0))},methods:{submit(){this.close({selection:this.selection,script:this.form.script})},toggleType(s,t){for(const i of this.keys){const e=f(i,this.plotTypes);s&&e!=="color"||!s&&e==="color"||(this.selection[i]=t)}},toggleOption(s){this.selection[s]=!this.selection[s]}}};var R=function(){var t=this,i=t._self._c;return i("Dialog",{staticClass:"indicator-preset-dialog",attrs:{size:"medium"},on:{clickOutside:t.close},scopedSlots:t._u([{key:"header",fn:function(){return[i("div",{staticClass:"dialog__title"},[t._v("Configure preset")])]},proxy:!0},{key:"footer",fn:function(){return[i("a",{staticClass:"btn -text mr8",attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.close(!1)}}},[t._v(" Cancel ")]),i("button",{staticClass:"btn -green -pill",attrs:{type:"button"},on:{click:t.submit}},[t.count>0?i("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"badge -red ml8",attrs:{title:t.submitLabel},domProps:{textContent:t._s(t.count)}}):t._e(),i("span",[i("i",{staticClass:"icon-save mr8"}),t._v(" Save")])])]},proxy:!0}])},[i("form",{ref:"form",on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[i("p",{staticClass:"mt0 mb0"},[t._v("Choose what to include")]),i("div",{staticClass:"d-flex"},[i("div",[i("div",{staticClass:"form-group mb8"},[i("label",{staticClass:"checkbox-control mt16"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.colors,expression:"form.colors"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.form.colors)?t._i(t.form.colors,null)>-1:t.form.colors},on:{input:function(e){return t.toggleType(!0,e.target.checked)},change:function(e){var o=t.form.colors,n=e.target,c=!!n.checked;if(Array.isArray(o)){var r=null,a=t._i(o,r);n.checked?a<0&&t.$set(t.form,"colors",o.concat([r])):a>-1&&t.$set(t.form,"colors",o.slice(0,a).concat(o.slice(a+1)))}else t.$set(t.form,"colors",c)}}}),i("div"),i("span",[t._v("Colors")]),i("i",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",distance:16},expression:"{ placement: 'top', distance: 16 }"}],staticClass:"icon-info pl4",attrs:{title:"Toggle all color options"}})])]),i("div",{staticClass:"form-group mb8"},[i("label",{staticClass:"checkbox-control"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.values,expression:"form.values"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.form.values)?t._i(t.form.values,null)>-1:t.form.values},on:{input:function(e){return t.toggleType(!1,e.target.checked)},change:function(e){var o=t.form.values,n=e.target,c=!!n.checked;if(Array.isArray(o)){var r=null,a=t._i(o,r);n.checked?a<0&&t.$set(t.form,"values",o.concat([r])):a>-1&&t.$set(t.form,"values",o.slice(0,a).concat(o.slice(a+1)))}else t.$set(t.form,"values",c)}}}),i("div"),i("span",[t._v("Options")]),i("i",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",distance:16},expression:"{ placement: 'top', distance: 16 }"}],staticClass:"icon-info pl4",attrs:{title:"Toggle all other options"}})])]),i("div",{staticClass:"form-group mb8"},[i("label",{staticClass:"checkbox-control"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.script,expression:"form.script"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.form.script)?t._i(t.form.script,null)>-1:t.form.script},on:{change:function(e){var o=t.form.script,n=e.target,c=!!n.checked;if(Array.isArray(o)){var r=null,a=t._i(o,r);n.checked?a<0&&t.$set(t.form,"script",o.concat([r])):a>-1&&t.$set(t.form,"script",o.slice(0,a).concat(o.slice(a+1)))}else t.$set(t.form,"script",c)}}}),i("div"),i("span",[t._v("Script")]),i("i",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",distance:16},expression:"{ placement: 'top', distance: 16 }"}],staticClass:"icon-info pl4",attrs:{title:"Include script in preset"}})])])])]),i("div",{staticClass:"indicator-preset-dialog__grid mt8"},[t._l(t.keys,function(e,o){return i("button",{key:o,staticClass:"btn indicator-preset-dialog__item -small",class:[t.selection[e]?"-green":"-text"],attrs:{type:"button"},on:{click:function(n){return t.toggleOption(e)}}},[t._v(" "+t._s(e)+" ")])}),i("button",{staticClass:"btn indicator-preset-dialog__item -small",class:[t.form.script?"-green":"-text"],attrs:{type:"button"},on:{click:function(e){t.form.script=!t.form.script}}},[t._v(" Script ")])],2)])])},z=[],F=m(L,R,z,!1,null,"1374d0f4",null,null);const j=F.exports;var W=Object.defineProperty,M=Object.getOwnPropertyDescriptor,v=(s,t,i,e)=>{for(var o=e>1?void 0:e?M(t,i):t,n=s.length-1,c;n>=0;n--)(c=s[n])&&(o=(e?c(t,i,o):c(o))||o);return e&&o&&W(t,i,o),o};let u=class extends T{constructor(){super(...arguments);d(this,"indicatorId");d(this,"paneId");d(this,"plotTypes");d(this,"name");d(this,"ensure");d(this,"type",null);d(this,"value",null)}get currentIndicatorValue(){return this.$store.state[this.paneId].indicators[this.indicatorId].options[this.name]}get definition(){return this.$store.state[this.paneId].indicators[this.indicatorId].optionsDefinitions[this.name]||{}}get label(){return this.definition.label||this.name}get componentName(){return this.type?this.name==="lineType"?"IndicatorOptionLineType":this.name==="lineStyle"?"IndicatorOptionLineStyle":`IndicatorOption${this.type[0].toUpperCase()}${this.type.toLowerCase().slice(1)}`:"IndicatorOptionText"}onDefinitionChange(){this.type=this.getType()}onIndicatorValueChange(){const i=this.getValue();(+this.value!=+i||isNaN(+this.value)&&i!==this.value)&&(this.value=i)}created(){this.value=this.getValue(),this.type=this.getType(),this.ensure&&typeof this.currentIndicatorValue>"u"&&this.value!=="null"&&this.setValue(this.value)}getType(){const i=this.definition.type||f(this.name,this.plotTypes,!0,this.currentIndicatorValue);return Object.values(P).includes(i)?i:"number"}getValue(){let i;if(typeof this.currentIndicatorValue<"u"&&(i=this.currentIndicatorValue),typeof i>"u"&&typeof this.definition.default<"u")return this.definition.default;const e=E(this.name,this.plotTypes);return typeof i<"u"?i&&typeof i=="object"&&e&&typeof e=="object"?Object.assign({},e,i):i:typeof e<"u"?e:null}setValue(i){this.$emit("change",{key:this.name,value:i}),this.value=i,this.type=this.getType()}};v([_("definition")],u.prototype,"onDefinitionChange",1);v([_("currentIndicatorValue")],u.prototype,"onIndicatorValueChange",1);u=v([C({name:"IndicatorOptions",components:{IndicatorOptionNumber:()=>l(()=>import("./IndicatorOptionNumber.5c4cb14.js"),["IndicatorOptionNumber.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js"]),IndicatorOptionText:()=>l(()=>import("./IndicatorOptionText.5c4cb14.js"),["IndicatorOptionText.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js"]),IndicatorOptionList:()=>l(()=>import("./IndicatorOptionList.5c4cb14.js"),["IndicatorOptionList.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js"]),IndicatorOptionLineStyle:()=>l(()=>import("./IndicatorOptionLineStyle.5c4cb14.js"),["IndicatorOptionLineStyle.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js"]),IndicatorOptionLineType:()=>l(()=>import("./IndicatorOptionLineType.5c4cb14.js"),["IndicatorOptionLineType.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js"]),IndicatorOptionExchange:()=>l(()=>import("./IndicatorOptionExchange.5c4cb14.js"),["IndicatorOptionExchange.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js"]),IndicatorOptionRange:()=>l(()=>import("./IndicatorOptionRange.5c4cb14.js"),["IndicatorOptionRange.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js","IndicatorOptionRange.5c4cb14.css"]),IndicatorOptionCheckbox:()=>l(()=>import("./IndicatorOptionCheckbox.5c4cb14.js"),["IndicatorOptionCheckbox.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js","IndicatorOptionCheckbox.5c4cb14.css"]),IndicatorOptionColor:()=>l(()=>import("./IndicatorOptionColor.5c4cb14.js"),["IndicatorOptionColor.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","indicatorOptionMixin.5c4cb14.js","IndicatorOptionColor.5c4cb14.css"])},props:{indicatorId:{type:String,required:!0},paneId:{type:String,required:!0},plotTypes:{required:!0},name:{type:String,required:!0},ensure:{type:Boolean,default:!1}}})],u);var Q=function(){var t=this,i=t._self._c;return t._self._setupProxy,i("div",{staticClass:"indicator-option"},[t.type?i(t.componentName,{tag:"component",attrs:{"pane-id":t.paneId,"indicator-id":t.indicatorId,label:t.label,value:t.value,definition:t.definition},on:{input:function(e){return t.setValue(e)}},scopedSlots:t._u([t.definition.description?{key:"description",fn:function(){return[i("i",{directives:[{name:"tippy",rawName:"v-tippy",value:{followCursor:!0,distance:24},expression:"{ followCursor: true, distance: 24 }"}],staticClass:"icon-info pl4",attrs:{title:t.definition.description}})]},proxy:!0}:null],null,!0)}):t._e()],1)},q=[],U=m(u,Q,q,!1,null,null,null,null);const G=U.exports,J=["crosshairMarkerVisible","minLength","visible","priceScaleId","priceFormat"],Y={components:{IndicatorOption:G,Tabs:K,Tab:$,DropdownButton:w,ToggableSection:x,Editor:()=>l(()=>import("./Editor.5c4cb14.js").then(s=>s.E),["Editor.5c4cb14.js","index.5c4cb14.js","index.5c4cb14.css","options.5c4cb14.js","Editor.5c4cb14.css"])},props:["paneId","indicatorId"],mixins:[g],data(){return{code:"",navigation:{optionsQuery:"",editorOptions:{},columnWidth:240,tab:"options"},resizingColumn:!1,loadedEditor:!1,plotTypes:[],defaultOptionsKeys:[],scriptOptionsKeys:[],colorOptionsKeys:[],dropdownIndicatorTrigger:null,helps:{priceScaleId:"Use <u>right</u> for binding indicator to main price scale. Otherwise use it as an id to align multiple indicator on same scale (as overlay)",lastValueVisible:"Show last value on right axis",priceLineVisible:"Show horizontal line at current value",borderVisible:"Only for candlestick series, enable borders of candles",lineWidth:"Only for line and area series",lineStyle:"Only for line and area series",lineType:"Only for line and area series"}}},computed:{indicator(){return this.$store.state[this.paneId].indicators[this.indicatorId]},libraryId(){return this.indicator.libraryId||this.indicatorId},displayName(){return this.indicator.displayName},displayId(){const s=this.libraryId;return s?s.length<=16?s:s.slice(0,6)+".."+s.substr(-6):"n/a"},presetPlaceholder(){return`${this.indicator.name.replace(/\{.*\}/,"").trim()} preset`},description(){return this.indicator.description},unsavedChanges(){return this.indicator.unsavedChanges},error(){return this.$store.state[this.paneId].indicatorsErrors[this.indicatorId]},name(){return this.indicator.displayName||this.indicator.name},script(){return this.indicator.script},precision(){return!this.indicator.options.priceFormat||this.indicator.options.priceFormat.auto?"auto":typeof this.indicator.options.priceFormat.precision=="number"?this.indicator.options.priceFormat.precision:2},priceFormat(){return this.indicator.options.priceFormat&&this.indicator.options.priceFormat.type||"price"},availableScales(){return N(this.$store.state[this.paneId].indicators,this.indicatorId)},queryOptionsKeys(){if(!this.navigation.optionsQuery.length)return[];const s=new RegExp(this.navigation.optionsQuery,"i");return[...this.scriptOptionsKeys,...this.defaultOptionsKeys,...this.colorOptionsKeys].filter(t=>s.test(t))},lastPreset:{get(){return this.indicator.lastPreset?this.indicator.lastPreset:"Presets"},set(s){this.indicator.lastPreset=s&&s.name||null}}},watch:{script:{handler(s){this.code=s},immediate:!0}},created(){this.restoreNavigation(),this.$nextTick(()=>{this.getPlotTypes(),this.getOptionsKeys()}),this.originalIndicator=JSON.parse(JSON.stringify(this.indicator))},beforeDestroy(){this.saveNavigation()},methods:{toggleCollapseColum(){this.navigation.columnWidth>50?this.navigation.columnWidth=0:this.navigation.columnWidth=240,this.resizeEditor()},handleColumnResize(s){this.resizingColumn=!0;let t=y(s).x;const i=o=>{const n=y(o).x;this.navigation.columnWidth+=t-n,t=n},e=o=>{o instanceof MouseEvent?(document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",e)):(document.removeEventListener("touchmove",i),document.removeEventListener("touchend",e)),this.navigation.columnWidth<50&&(this.navigation.columnWidth=0),this.resizeEditor(),this.resizingColumn=!1};s instanceof MouseEvent?(document.addEventListener("mousemove",i),document.addEventListener("mouseup",e)):(document.addEventListener("touchmove",i),document.addEventListener("touchend",e))},restoreNavigation(){const s=this.$store.state.settings.indicatorDialogNavigation;if(s)try{const t=JSON.parse(s);for(const i in t)this.navigation[i]=t[i]}catch(t){console.error("Failed to parse navigation state",t)}},saveNavigation(){this.$store.commit("settings/SET_INDICATOR_DIALOG_NAVIGATION",this.navigation)},setPriceScale(s){this.$store.dispatch(this.paneId+"/setIndicatorOption",{id:this.indicatorId,key:"priceScaleId",value:s})},updateScript(s){this.$store.commit(this.paneId+"/SET_INDICATOR_SCRIPT",{id:this.indicatorId,value:s?s.trim():void 0}),this.getPlotTypes(),this.getOptionsKeys()},updateIndicatorOptions(s){this.$set(this.navigation,"editorOptions",s)},getScriptOptions(s){const t=Object.keys(this.indicator.optionsDefinitions||{}),i=/options\.([a-zA-Z0-9_]+)|[\s\n]*(\w[\d\w]+)[\s\n]*=[\s\n]*option\(/g;let e;do(e=i.exec(s))&&e[1]&&t.indexOf(e[1])===-1&&t.push(e[1]);while(e);return t},getPlotTypes(){const s=Object.keys(h).map(t=>t.replace(/[^\w]/g,""));this.plotTypes=(this.script.match(new RegExp(`(?:\\n|\\s|^)(?:plot)?(${s.join("|")})\\(`,"g"))||[]).map(t=>{const i=t.replace(/[^\w]/g,"").replace(/^plot/,"");return D[i]||i}).filter((t,i,e)=>e.indexOf(t)===i&&h[t])},async removeIndicator(){await this.close(),this.$store.dispatch(this.paneId+"/removeIndicator",{id:this.indicatorId})},async resizeIndicator(){await this.close(),this.$store.commit(this.paneId+"/TOGGLE_LAYOUTING",this.indicatorId)},async renameIndicator(){const s=await p.prompt({action:"Rename",input:this.$store.state[this.paneId].indicators[this.indicatorId].name});typeof s=="string"&&s!==this.name&&this.$store.dispatch(this.paneId+"/renameIndicator",{id:this.indicatorId,name:s})},async downloadIndicator(){this.$store.dispatch(this.paneId+"/downloadIndicator",this.indicatorId)},async duplicateIndicator(){this.$store.dispatch(this.paneId+"/duplicateIndicator",this.indicatorId),await this.close(),p.openIndicator(this.paneId,this.indicatorId)},async saveIndicator(){this.$store.dispatch(this.paneId+"/saveIndicator",this.indicatorId)},async undoIndicator(){await p.confirm("Undo changes ?")&&this.$store.dispatch(this.paneId+"/undoIndicator",{libraryId:this.libraryId,indicatorId:this.indicatorId})},async getIndicatorPreset(s){const t=[...this.colorOptionsKeys,...this.scriptOptionsKeys,...this.defaultOptionsKeys],i=await p.openAsPromise(j,{keys:t,plotTypes:this.plotTypes,originalKeys:s?Object.keys(s.data.options):this.scriptOptionsKeys});if(i){if(typeof Object.values(i.selection).find(o=>!!o)>"u"&&!i.script){this.$store.dispatch("app/showNotice",{title:"You did not select anything to save in the preset !",type:"error"});return}const e={options:{}};for(const o of t)i.selection[o]&&(e.options[o]=A(this.paneId,this.indicatorId,o,this.plotTypes));return i.script&&(e.script=this.script),e}},getOptionsKeys(){const s=this.getScriptOptions(this.script),t=Object.keys(V),i=this.plotTypes.reduce((r,a)=>[...r,...Object.keys(h[a]||{})],[]),e=[...t,...i,...s].filter((r,a,I)=>J.indexOf(r)===-1&&I.indexOf(r)==a),o=[],n=[],c=[];for(let r=0;r<e.length;r++){const a=e[r];f(a,this.plotTypes,!1,this.indicator.options[a])==="color"?o.push(e.shift()):s.indexOf(a)!==-1?n.push(e.shift()):c.push(e.shift()),r--}this.scriptOptionsKeys=n,this.defaultOptionsKeys=c,this.colorOptionsKeys=o},applyIndicatorPreset(s){const t=s?s.data:null,i=this.$store.state[this.paneId].indicators[this.indicatorId];if(this.lastPreset=s,t)S(i,t);else{const e=this.scriptOptionsKeys.concat(this.defaultOptionsKeys,this.colorOptionsKeys);for(const o of e){const n=this.getDefaultValue(o);typeof n<"u"&&(i.options[o]=n)}}this.otherOptionsKeys=this.colorOptionsKeys=[],this.$nextTick(()=>{this.$store.commit(this.paneId+"/SET_INDICATOR_SCRIPT",{id:this.indicatorId}),this.getPlotTypes(),this.getOptionsKeys(),this.$store.commit(this.paneId+"/FLAG_INDICATOR_AS_UNSAVED",this.indicatorId)})},async toggleIndicatorAsDefault(){if(!(this.unsavedChanges&&!await p.confirm("Indicator has unsaved changes, save it and turn "+(this.indicator.enabled?"off":"on")+" default ?")))return this.indicator.enabled=!this.indicator.enabled,this.saveIndicator()},setPriceFormat(s,t){let i=!1,e=Math.round(t);(t===""||isNaN(e))&&(i=!0,e=2);const o={type:s,precision:e,minMove:1/Math.pow(10,e),auto:i};this.$store.dispatch(this.paneId+"/setIndicatorOption",{id:this.indicatorId,key:"priceFormat",value:o}),this.$store.commit(this.paneId+"/SET_PRICE_SCALE",{id:this.indicator.options.priceScaleId,priceScale:{...this.$store.state[this.paneId].priceScales[this.indicator.options.priceScaleId],priceFormat:{type:s,precision:e,minMove:1/Math.pow(10,e),auto:i}}})},copyIndicatorId(){k(this.indicatorId),this.$store.dispatch("app/showNotice",{title:"Copied indicator id to clipboard"})},toggleIndicatorDropdown(s){this.dropdownIndicatorTrigger?this.dropdownIndicatorTrigger=null:this.dropdownIndicatorTrigger=s.currentTarget},setIndicatorOption({key:s,value:t}){this.$store.dispatch(this.paneId+"/setIndicatorOption",{id:this.indicatorId,key:s,value:t})},resizeEditor(){this.$refs.editor&&this.$refs.editor.resize()},onResize(){this.resizeEditor()},revertChanges(){this.applyIndicatorPreset({data:this.originalIndicator})},async setTab(s){this.navigation.tab=s,this.navigation.tab==="script"&&(this.loadedEditor=!0),await this.$nextTick(),this.resizeEditor(),this.saveNavigation()}}};var B=function(){var t=this,i=t._self._c;return i("Dialog",{staticClass:"indicator-dialog",class:[!t.navigation.columnWidth&&"indicator-dialog--collapsed-column",t.resizingColumn&&"indicator-dialog--resizing-column"],attrs:{size:"wide",mask:!1,"close-on-escape":!1,contrasted:""},on:{clickOutside:t.close,resize:t.onResize},scopedSlots:t._u([{key:"header",fn:function(){return[i("div",{staticClass:"dialog__title indicator-dialog__title -center"},[i("div",{on:{dblclick:t.renameIndicator}},[t._v(t._s(t.name))]),i("code",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"indicator-dialog__id -filled",attrs:{title:t.libraryId},on:{click:t.copyIndicatorId}},[i("small",[t._v(t._s(t.displayId))])])]),i("a",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn -text -white mlauto -center -no-grab indicator-dialog__action",attrs:{href:"https://github.com/Tucsky/aggr/wiki/introduction-to-scripting",target:"_blank",title:"Scripting documentation"}},[i("i",{staticClass:"icon-info"}),i("span",{staticClass:"ml8"},[t._v("Wiki")])]),t.unsavedChanges?i("button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn ml8 -text -no-grab indicator-dialog__action",attrs:{title:"Rollback changes"},on:{click:t.undoIndicator}},[i("i",{staticClass:"icon-eraser"}),i("span",{staticClass:"ml8"},[t._v("Discard")])]):t._e(),i("button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn ml8 -no-grab indicator-dialog__action",class:[!t.unsavedChanges&&"-text",t.unsavedChanges&&"-green"],attrs:{title:"Save changes"},on:{click:t.saveIndicator}},[i("i",{staticClass:"icon-save"}),i("span",{staticClass:"ml8"},[t._v("Save")])])]},proxy:!0},{key:"subheader",fn:function(){return[i("tabs",{attrs:{value:t.navigation.tab},on:{input:t.setTab}},[i("tab",{attrs:{name:"script"}},[t._v("Script")]),i("tab",{attrs:{name:"options"}},[t._v("Options")])],1)]},proxy:!0},{key:"footer",fn:function(){return[i("presets",{staticClass:"mr8 -left",attrs:{type:"indicator:"+t.libraryId,adapter:t.getIndicatorPreset,placeholder:t.presetPlaceholder,label:t.lastPreset,"show-reset":!1},on:{apply:function(e){return t.applyIndicatorPreset(e)}}}),i("button",{staticClass:"btn -text -arrow",on:{click:t.toggleIndicatorDropdown}},[t._v(" Options ")]),i("dropdown",{model:{value:t.dropdownIndicatorTrigger,callback:function(e){t.dropdownIndicatorTrigger=e},expression:"dropdownIndicatorTrigger"}},[i("div",{staticClass:"dropdown-item"},[i("label",{staticClass:"checkbox-control -small",on:{mousedown:function(e){e.preventDefault()}}},[i("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.indicator.enabled},on:{change:t.toggleIndicatorAsDefault}}),i("div"),i("span",[t._v("Use as default")]),i("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info text-muted ml8",attrs:{title:"New charts to use this indicator"}})])]),i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.copyIndicatorId}},[i("i",{staticClass:"icon-copy-paste"}),t._v(" "),i("span",[t._v("Copy ID")]),i("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info text-muted ml8",attrs:{title:"ID can be used to reference in other indicator using $ sign followed by the id ($price)"}})]),i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.resizeIndicator}},[i("i",{staticClass:"icon-resize-height"}),t._v(" "),i("span",[t._v("Resize")])]),i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.downloadIndicator}},[i("i",{staticClass:"icon-download"}),t._v(" "),i("span",[t._v("Download")])]),i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.duplicateIndicator}},[i("i",{staticClass:"icon-copy-paste"}),t._v(" "),i("span",[t._v("Duplicate")])]),i("div",{staticClass:"dropdown-divider"}),i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.revertChanges}},[i("i",{staticClass:"icon-refresh"}),t._v(" "),i("span",[t._v("Revert changes")])]),i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.removeIndicator}},[i("i",{staticClass:"icon-cross"}),t._v(" "),i("span",[t._v("Unload")])])])]},proxy:!0}])},[t.loadedEditor?i("div",{directives:[{name:"show",rawName:"v-show",value:t.navigation.tab==="script",expression:"navigation.tab === 'script'"}],staticClass:"indicator-editor"},[t.error?i("p",{staticClass:"form-feedback ml16"},[i("i",{staticClass:"icon-warning mr4"}),t._v(" "+t._s(t.error)+" ")]):t._e(),i("editor",{ref:"editor",attrs:{value:t.code,"editor-options":t.navigation.editorOptions},on:{blur:t.updateScript,options:t.updateIndicatorOptions}})],1):t._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:t.navigation.tab==="options",expression:"navigation.tab === 'options'"}],staticClass:"indicator-options indicator-options--tab hide-scrollbar"},[t.scriptOptionsKeys.length?i("ToggableSection",{attrs:{badge:t.scriptOptionsKeys.length,title:"Script options",id:"indicator-left-script"}},[i("div",{staticClass:"indicator-options__grid"},t._l(t.scriptOptionsKeys,function(e){return i("indicator-option",{key:e,staticClass:"indicator-options__option",attrs:{name:e,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes,ensure:""},on:{change:t.setIndicatorOption}})}),1)]):t._e(),t.colorOptionsKeys.length?i("ToggableSection",{attrs:{badge:t.colorOptionsKeys.length,title:"Colors",id:"indicator-left-colors"}},[i("div",{staticClass:"indicator-options__grid"},t._l(t.colorOptionsKeys,function(e){return i("indicator-option",{key:e,staticClass:"indicator-options__option",attrs:{name:e,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes},on:{change:t.setIndicatorOption}})}),1)]):t._e(),t.defaultOptionsKeys.length?i("ToggableSection",{attrs:{badge:t.defaultOptionsKeys.length,title:"Other options",id:"indicator-left-other"}},[i("div",{staticClass:"indicator-options__grid"},t._l(t.defaultOptionsKeys,function(e){return i("indicator-option",{key:e,staticClass:"indicator-options__option",attrs:{name:e,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes},on:{change:t.setIndicatorOption}})}),1)]):t._e()],1),i("div",{staticClass:"indicator-delimiter"},[i("div",{staticClass:"indicator-delimiter__resizer",on:{mousedown:t.handleColumnResize,touchstart:t.handleColumnResize}}),i("button",{staticClass:"btn indicator-delimiter__collapser -text",on:{click:t.toggleCollapseColum}},[i("i",{staticClass:"icon-up-thin"})])]),i("div",{staticClass:"indicator-options indicator-options--column hide-scrollbar",style:{width:t.navigation.columnWidth+"px"}},[i("div",{staticClass:"indicator-search input-group",class:[t.navigation.optionsQuery&&"indicator-search--active"]},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.navigation.optionsQuery,expression:"navigation.optionsQuery"}],staticClass:"form-control",attrs:{type:"text",placeholder:"search option..."},domProps:{value:t.navigation.optionsQuery},on:{input:function(e){e.target.composing||t.$set(t.navigation,"optionsQuery",e.target.value)}}}),t.navigation.optionsQuery?i("button",{staticClass:"btn -text -small",attrs:{type:"button"},on:{click:function(e){t.navigation.optionsQuery=""}}},[i("i",{staticClass:"icon-cross"})]):t._e()]),t.navigation.optionsQuery.length?i("div",{staticClass:"indicator-options__list indicator-search__results"},[t._l(t.queryOptionsKeys,function(e){return i("indicator-option",{key:e,attrs:{name:e,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes},on:{change:t.setIndicatorOption}})}),t.queryOptionsKeys.length?t._e():i("p",[t._v("No results")])],2):[t.colorOptionsKeys.length?i("ToggableSection",{attrs:{badge:t.colorOptionsKeys.length,title:"Colors",id:"indicator-right-colors"}},[i("div",{staticClass:"indicator-options__list"},t._l(t.colorOptionsKeys,function(e){return i("indicator-option",{key:e,attrs:{name:e,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes,inline:""},on:{change:t.setIndicatorOption}})}),1)]):t._e(),t.scriptOptionsKeys.length?i("ToggableSection",{attrs:{badge:t.scriptOptionsKeys.length,title:"Script",id:"indicator-right-script"}},[i("div",{staticClass:"indicator-options__list"},t._l(t.scriptOptionsKeys,function(e){return i("indicator-option",{key:e,attrs:{name:e,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes,ensure:""},on:{change:t.setIndicatorOption}})}),1)]):t._e(),t.defaultOptionsKeys.length?i("ToggableSection",{attrs:{badge:t.defaultOptionsKeys.length,title:"Other",id:"indicator-right-default"}},[i("div",{staticClass:"indicator-options__list"},t._l(t.defaultOptionsKeys,function(e){return i("indicator-option",{key:e,attrs:{name:e,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes},on:{change:t.setIndicatorOption}})}),1)]):t._e(),i("ToggableSection",{attrs:{title:"Scale",id:"indicator-right-scale"}},[i("div",{staticClass:"form-group"},[i("label",[t._v("Scale with "),i("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.helps.priceScaleId}})]),i("dropdown-button",{staticClass:"-outline form-control -arrow w-100",attrs:{value:t.indicator.options.priceScaleId,options:t.availableScales,placeholder:"Default scale"},on:{input:function(e){return t.setPriceScale(e)}}})],1)]),i("ToggableSection",{attrs:{title:"Format",id:"indicator-right-format"}},[i("div",{staticClass:"d-flex mb4"},[i("div",{staticClass:"mrauto"},[t._v("Format")]),i("div",[t._v("Precision")])]),i("div",{staticClass:"d-flex"},[i("dropdown-button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"mr8 -outline form-control -arrow",attrs:{value:t.priceFormat,options:["price","volume","percent"],title:"Volume uses abbreviation for Million and Thousand"},on:{input:function(e){return t.setPriceFormat(e,t.precision)}}}),i("editable",{staticClass:"form-control mlauto",attrs:{value:t.precision},on:{input:function(e){return t.setPriceFormat(t.priceFormat,e)}}})],1)])]],2)])},H=[],X=m(Y,B,H,!1,null,"f4c0d1d8",null,null);const ot=X.exports;export{ot as default};
